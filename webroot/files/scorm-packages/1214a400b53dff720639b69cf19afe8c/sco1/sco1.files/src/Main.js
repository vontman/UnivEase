define("Main",["CScriptManager","CMasterManager","CMouseManager","CBitmapManager","CVideoManager","CObjectSyncManager","CEBoardManager","CControlManager","CFrontBuffer","ContextMenu","Point","Rectangle","Timer","Capabilities","SLIDEEND","SOUND","VIDEOOPEN","CBrowserInfo","CBrowserManager","CQuizManager","CQuiz_Manager"],function(CScriptManager,CMasterManager,CMouseManager,CBitmapManager,CVideoManager,CObjectSyncManager,CEBoardManager,CControlManager,CFrontBuffer,ContextMenu,Point,Rectangle,Timer,Capabilities,SLIDEEND,SOUND,VIDEOOPEN,CBrowserInfo,CBrowserManager,CQuizManager,CQuiz_Manager){function Main(){if(window.console==undefined){console={log:function(){}}}this.bDragging=false;this.pointMouseDown=new Point(-1,-1);this.rectMouseDown=new Rectangle();this.rectMouseUp=new Rectangle();this.mousepoint=new Point()}Main.prototype={uBackgroundColor:16777215,iAlpha:0.1,globalPause:false,bBackgroundSlide:false,bAutoJump:false,bPageTracking:false,nCurrentSlideNo:0,nMaxViewSlideNo:1,bStopEboard:false,nSlideStartTime:0,nNaviButton:0,timerArray:[Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000),Timer.New(1000)],timerStart:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],nVideoNoSyncObject:-1,nSlideSyncObject:0,nSlideStartTimeStart:0,nSlideStartTimeEnd:-1,bSyncObjectTimer:false,bFullScreen:false,bRunMaster:false,nSildeRunTime:0,nAutoObjectNo:1000,bTouchSwipe:true,bPaused:false,nLastPlayTime:-1,nMaxPlayedTime:-1,nLastVideoNo:-1,bVideoMoveForward:false,arrayAllowDomains:null,LangID:1,GlobalPause:function(){return this.globalPause},MasterManager:function(){return this.masterManager},ScriptManager:function(){return this.scriptManager},VideoManager:function(){return this.videoManager},MouseManager:function(){return this.mouseManager},QuizManager:function(){return this.quizManager},Quiz_Manager:function(){return this.quiz_Manager},BitmapManager:function(){return this.bitmapManager},BrowserManager:function(){return this.browserManager},ControlManager:function(){return this.controlManager},ObjectSyncManager:function(){return this.objectSyncManager},OnCreationComplete:function(){var request=new Request();Viewer.BuildVersion=request.getParameter("r");if(undefined!=window.ABridge){Viewer.isAnApp=Viewer.isAndroid;Viewer.isIOSApp=Viewer.isIOS}this.LangID=Viewer.LangID;Capabilities.LangID=this.LangID;if(Viewer.isFireFox){(function(){var events=["mousedown","mouseover","mouseout","mousemove","mousedrag","click","dblclick"];for(var i=0;i<events.length;i++){window.addEventListener(events[i],function(e){window.event=e;window.event.srcElement=e.target},true)}}());HTMLElement.prototype.__defineGetter__("innerText",function(){return this.textContent});HTMLElement.prototype.__defineSetter__("innerText",function(txt){this.textContent=txt})}if(Viewer.isIOS){var m=document.createElement("meta");m.setAttribute("id","viewport");m.setAttribute("name","viewport");m.setAttribute("content","width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1");$("head").append(m)}$(window).resize(function(){var dw=document.body.clientWidth;var dh=document.body.clientHeight;var scaleW=dw/Viewer.SlideWidth;var scaleH=dh/Viewer.SlideHeight;var scale=scaleW>scaleH?scaleH:scaleW;if(scale>1){scale=1}if(Viewer.isIOS&&scale<1){scale*=0.98}$(".frameCover").css("-webkit-transform","scale("+scale+")");$(".frameCover").css("-moz-transform","scale("+scale+")");$(".frameCover").css("-ms-transform","scale("+scale+")")});$(window).resize();var coverWidth=0;var coverHeight=0;if(Viewer.bControlCover){coverWidth=18;coverHeight=92;$("#topBar").addClass("unhideable");$("#controls").addClass("unhideable");$(".framePane").css("background-color","#ddd");$(".frameCover").css("background-color","#ddd")}$(".frameCover").css("width",Viewer.SlideWidth+coverWidth);$(".frameCover").css("height",Viewer.SlideHeight+coverHeight);$(".frameCover").css("margin-left",(Viewer.SlideWidth+coverWidth)/-2);$(".frameCover").css("margin-top",(Viewer.SlideHeight+coverHeight)/-2);$(".framePane").css("width",Viewer.SlideWidth);$(".framePane").css("margin-left",Viewer.SlideWidth/-2);$("body").bind("contextmenu",function(){if(event.target.localName!="embed"){return false}});$(".controlbar-button").bind("mouseover",function(){$(this).addClass("hover")});$(".controlbar-button").bind("mouseout",function(){$(this).removeClass("hover")});$(".controlbar-button").bind("mousedown",function(){$(this).addClass("pressed")});$(".controlbar-button").bind("mouseup",function(){$(this).removeClass("pressed")});$(".controlbar-button").bind("mouseleave",function(){$(this).removeClass("pressed")});$("#control-next").bind("click",function(){main.NextSlide()});$("#control-previous").bind("click",function(){main.PrevSlide()});var mainDiv=document.getElementById("imageCanvas");mainDiv.style.width=Viewer.SlideWidth+"px";mainDiv.style.height=Viewer.SlideHeight+"px";this.contextMenu=this.addContextMenu(1);this.arrayAllowDomains=Viewer.arrayDomains;this.scriptManager=new CScriptManager(Viewer.arrayScripts);this.masterManager=new CMasterManager(Viewer.arrayMasters);this.frontBuffer=new CFrontBuffer(Viewer.SlideWidth,Viewer.SlideHeight,this.uBackgroundColor,mainDiv);this.mouseManager=new CMouseManager();this.videoManager=new CVideoManager();this.objectSyncManager=new CObjectSyncManager();this.textAreaArray=new Array();this.textAreaIDArray=new Array();this.quizManager=new CQuizManager();this.quiz_Manager=new CQuiz_Manager();this.bitmapManager=new CBitmapManager();this.stopType=null;this.eboardManager=new CEBoardManager();this.browserManager=new CBrowserManager();this.controlManager=new CControlManager();this.visitArray=new Array(this.scriptManager.GetSlideCount());this.quizNumber=new Array(Viewer.QuizTotalCount);this.quizPoint=new Array(Viewer.QuizTotalCount);this.quizResult=new Array(Viewer.QuizTotalCount);this.InitQuizInfo();this.InitVisitInfo();this.MouseEvent_MOUSE_DOWN=mainDiv.addEventListener("mousedown",this.EventHandlerMouse);this.MouseEvent_MOUSE_MOVE=mainDiv.addEventListener("mousemove",this.EventHandlerMouse);this.MouseEvent_MOUSE_OVER=mainDiv.addEventListener("mouseover",this.EventHandlerMouse);this.MouseEvent_MOUSE_UP=mainDiv.addEventListener("mouseup",this.EventHandlerMouse);if($("#imageCanvas").touchwipe){$("#imageCanvas").touchwipe({wipeLeft:function(){if(event.touches.length>1){return}if(event.target.localName=="video"||event.target.localName=="audio"){return}if(main.bTouchSwipe){main.GotoSlideStartNext()}},wipeRight:function(){if(event.touches.length>1){return}if(event.target.localName=="video"||event.target.localName=="audio"){return}if(main.bTouchSwipe){main.GotoSlideStartPrev()}},min_move_x:50,min_move_y:50,preventDefaultEvents:false})}if(Viewer.isIOS==false&&Viewer.isAndroid==false){document.body.addEventListener("keypress",function(ev){if(ev.target.localName=="textarea"){return}var key;var isShift;if(window.event&&window.event.keyCode){key=window.event.keyCode;isShift=window.event.shiftKey?true:false}else{key=ev.which;isShift=ev.shiftKey?true:false}if(isShift){switch(key){case 16:break;default:if(key==76){if($("#imageCanvas").css("border").indexOf("dashed")==-1){$("#imageCanvas").addClass("slideBorder")}else{$("#imageCanvas").removeClass("slideBorder")}}if(key==86){jAlert("HTML5Viewer : "+Viewer.BuildVersion+"\r\nLectureMAKER : ","",2)}break}}else{if(key==13||key==32){if($("#popup_ok").length){$("#popup_ok").trigger("click")}else{main.mouseManager.OnMouseClick()}}}})}document.LectureMaker=this;if(this.CheckDomain()==false){this.ShowNotAllowedWebSiteMessage(this.langID);return}if(Viewer.isIE){sleep(1000)}if(Viewer.bWaterMark){this.ShowWaterMark()}this.nSildeRunTime=new Date().getTime();if(Viewer.isAnApp&&Viewer.playLoader){this.LoadData();return}this.PreRun();this.Run()},LoadData:function(){var absoluteUrl=document.URL.substring(0,document.URL.lastIndexOf("/")+1);window.ABridge.prepareAudio(absoluteUrl+Viewer.playLoader)},preparedAudio:function(){main.PreRun();main.Run()},ShowNotAllowedWebSiteMessage:function(langID){var message=Capabilities.Message(Capabilities.Langueges.NotAllowedWebSite);jAlert(message,"",4)},CheckDomain:function(){if(this.arrayAllowDomains==null||this.arrayAllowDomains.length==0){return true}var sServerName=function(url){var a=url.indexOf(":");var b=url.indexOf(":",a+1);var c=url.indexOf("/",a+3);return url.substring(a+3,b==-1?c:b)}(location.href);for(index in this.arrayAllowDomains){var domain=this.arrayAllowDomains[index].toLowerCase();if(domain.length==0){continue}if(sServerName.indexOf(domain)!=-1){return true}if(domain.indexOf(sServerName)!=-1){return true}}return false},PrevSlide:function(event){main.GotoSlideStartPrev()},NextSlide:function(event){main.GotoSlideStartNext()},addContextMenu:function(nShow){var message=Capabilities.Message(Capabilities.Langueges.ContextMenu);var sPrev=message[0];var sNext=message[1];var myContextMenu=new ContextMenu();if(nShow==1){myContextMenu.AppendMenu(sPrev,this.PrevSlide);myContextMenu.AppendMenu(sNext,this.NextSlide)}return myContextMenu},eval:function(sParam){var param=sParam.toUpperCase();switch(param){case"SLIDEINFO(2)":return this.GetCurrentSlideNo();case"SLIDEINFO(3)":return this.GetSlideCount();case"SLIDEINFO(4)":return this.nMaxViewSlideNo;case"SLIDEINFO(10)":return this.GetSlideViewCount();case"SLIDEINFO(12)":return this.GetSlideViewStatus();case"SLIDEINFO(14)":return this.GetSlideProgressRate();case"QUIZINFO(0)":return this.quiz_Manager.GetQuiz_Info(0).toString();case"QUIZINFO(1)":return this.quiz_Manager.GetQuiz_Info(1).toString();case"QUIZINFO(2)":return this.quiz_Manager.GetQuiz_Info(2).toString();case"QUIZINFO(3)":return this.quiz_Manager.GetQuiz_Info(3).toString();case"QUIZINFO(4)":return this.quiz_Manager.GetQuiz_Info(4).toString();case"QUIZINFO(5)":return this.quiz_Manager.GetQuiz_Info(5).toString();case"QUIZINFO(6)":return this.quiz_Manager.GetQuiz_Info(6).toString();case"QUIZINFO(7)":return this.quiz_Manager.GetQuiz_Info(7).toString();case"QUIZINFO(8)":return this.quiz_Manager.GetQuiz_Info(8).toString();case"QUIZINFO(9)":return this.quiz_Manager.GetQuiz_Info(9).toString();case"QUIZINFO(12,1)":return this.quiz_Manager.GetQuiz_Info(12,1).toString();case"QUIZINFO(17)":return this.quiz_Manager.GetQuiz_Info(17).toString();case"VIDEOINFO(,8)":return this.videoManager.GetVideo_Info(-1,8).toString();case"VIDEOINFO(,13)":return this.videoManager.GetVideo_Info(-1,13).toString();default:var iIndex,iIndex2;iIndex=param.indexOf("QUIZINFO(18");if(iIndex>=0){iIndex=sParam.indexOf('"');if(iIndex>=0){str=sParam.substring(iIndex+1);str=str.replace(/\u0022/g,"");return main.quiz_Manager.GetQuiz_Info(18,1,"",str).toString()}return""}iIndex=param.indexOf("QUIZINFO(1");if(iIndex>=0){var str;var iInfo;var iQuizNo=1;str=sParam.substring(iIndex+9);iInfo=parseInt(str);iIndex=sParam.indexOf(",");if(iIndex>=0){str=sParam.substring(iIndex+1);iQuizNo=parseInt(str)}return this.quiz_Manager.GetQuiz_Info(iInfo,iQuizNo).toString()}iIndex=param.indexOf("SLIDEINFO(11");if(iIndex>=0){var iSlideNo;iIndex=sParam.indexOf(",");if(iIndex>=0){str=sParam.substring(iIndex+1);iSlideNo=parseInt(str);if(iSlideNo<=this.visitArray.length){var iRet=this.visitArray[iSlideNo-1]&1;return iRet.toString()}}}iIndex=param.indexOf("SLIDEINFO(13,");if(iIndex>=0){var state=sParam.substring(iIndex+14,sParam.length-2);this.SetSlideViewStatus(state)}iIndex=param.indexOf("TEXTINFO(");if(iIndex>=0){iIndex=sParam.indexOf(",");var value=null;var id=sParam.substr(9,iIndex-9);var cmd=parseInt(sParam.substring(iIndex+1));if(id=="undefined"){id=""}if(id){var obj=document.getElementsByClassName("item edit "+id);if(obj.length>0){value=obj[0].childNodes[0].value}}else{var obj=document.getElementsByClassName("item edit");if(obj.length>0){value=obj[obj.length-1].childNodes[0].value}}return value}}return""},exec:function(sParam){sParam=sParam.toUpperCase();var nIndex;var nValue;nIndex=sParam.indexOf("GOTO",0);if(nIndex>-1){nValue=parseInt(sParam.substring(nIndex+4));this.GotoSlideStartNo(nValue);return}nIndex=sParam.indexOf("VIDEO",0);if(nIndex>-1){var aryParam=sParam.split(",");if(aryParam.length>=10){this.nLastPlayTime=aryParam[7];this.nMaxPlayedTime=aryParam[9];this.bVideoMoveForward=true}return}},InitVisitInfo:function(){for(var i=0;i<this.visitArray.length;i++){this.visitArray[i]=0}},InitQuizInfo:function(){this.scriptManager.SetQuizInfo();for(var i=0;i<this.quizResult.length;i++){this.quizResult[i]="-"}},EventHandlerMouse:function(mouseEvent){if(mouseEvent.target.parentElement.parentElement&&mouseEvent.target.parentElement.parentElement.id!="EBoard"&&(mouseEvent.type=="mousemove"||mouseEvent.type=="mouseover")){return}if(document.getElementById("contextmenu")&&document.getElementById("contextmenu").style.display!="none"){return}if(mouseEvent.target.parentElement.onclick){return}if(mouseEvent.target.localName=="video"){mouseEvent.target.parentElement.focus();return}if(mouseEvent.target.localName=="audio"||mouseEvent.target.localName=="select"||mouseEvent.target.localName=="option"||mouseEvent.target.localName=="embed"){return}if(mouseEvent.target.firstChild&&mouseEvent.target.firstChild.localName=="select"){return}if(mouseEvent.target.localName=="textarea"&&!mouseEvent.target.draggable){return}if(mouseEvent.target.parentElement&&mouseEvent.target.parentElement.id=="eBoardControlPanel"){return}if(mouseEvent.target.parentElement&&mouseEvent.target.parentElement.parentElement&&mouseEvent.target.parentElement.parentElement.id=="eBoardControlPanel"){return false}if(mouseEvent.target.tagName=="INPUT"&&mouseEvent.type=="mouseup"&&mouseEvent.target!=mouseEvent.currentTarget){return}if(mouseEvent.button==2){return}switch(mouseEvent.type){case"mousemove":main.mouseManager.OnMouseMove(mouseEvent);break;case"mouseover":break;case"mouseout":break;case"mousedown":main.bDragging=true;main.pointMouseDown=main.pointLocal;main.rectMouseDown=main.mouseManager.OnMouseDown(mouseEvent);break;case"mouseup":main.rectMouseUp=main.mouseManager.OnMouseUp(mouseEvent);if(main.rectMouseDown==main.rectMouseUp){main.mouseManager.OnMouseClick(mouseEvent)}main.bDragging=false;main.pointMouseDown=new Point(-1,-1);break}},SlideStart:function(sSlideName,uColor){this.scriptManager.SlideStart();SOUND.prototype.SlideStart();this.frontBuffer.SlideStart(uColor);this.mouseManager.SlideStart();this.videoManager.SlideStart(sSlideName);this.eboardManager.SlideStart(sSlideName);this.browserManager.SlideStart();this.quizManager.SlideStart();this.bitmapManager.SlideStart();this.controlManager.SlideStart();this.objectSyncManager.SlideStart();this.DeleteAllTextArea()},Draw:function(bitmapDrawable){this.frontBuffer.Draw(bitmapDrawable)},FloodFill:function(iX,iY,uPaintColor,uBoundColor,iPatternNum,iBkColor,iRops){this.frontBuffer.FloodFill(iX,iY,uPaintColor,uBoundColor,iPatternNum,iBkColor,iRops)},GetBitmapData:function(rectangle){return this.frontBuffer.GetBitmapData(rectangle)},ClearBitmapData:function(rectangle){return this.frontBuffer.ClearBitmapData(rectangle)},ClearFrontBuffer:function(){this.frontBuffer.Clear()},ClearDraw:function(bitmapData){this.ClearFrontBuffer();this.ClearEBoardItem()},Clear:function(bitmapDrawable){this.frontBuffer.Clear(bitmapDrawable)},Run:function(){this.Continue()},Continue:function(){this.scriptManager.Run()},PreRun:function(){this.scriptManager.PreRun()},Resume:function(){if(main.bRunMaster){window.ABridge.sleepNGo("bRunMaster","main.Resume()",100)}else{window.ABridge.cancelNGo("bRunMaster");main.scriptManager.Run()}},GotoSlideStartFirst:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartFirst();if(bRun){this.Run()}},GotoSlideStartLast:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartLast();if(bRun){this.Run()}},GotoSlideStartNext:function(bRun){if(bRun==undefined){bRun=true}this.bRunMaster=false;this.GotoSlideStartNextWithoutMessage(bRun)},GotoSlideStartPrev:function(bRun){if(bRun==undefined){bRun=true}this.bRunMaster=false;if(this.scriptManager.IndexCurrentSlideStart()==0){return}this.GotoSlideStartPrevWithoutMessage(bRun)},GotoSlideStartNextWithoutMessage:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartNext();if(bRun){this.Run()}},GotoSlideStartPrevWithoutMessage:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartPrev();if(bRun){this.Run()}},GotoSlideStart:function(sSlideName,bRun){if(bRun==undefined){bRun=true}if(this.scriptManager.GotoSlideStart(sSlideName)==true){if(bRun){this.Run()}}},FindSlide:function(sSlideName){return this.scriptManager.FindSlide(sSlideName)},GotoSlideStartBefore:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartBefore();if(bRun){this.Run()}},GotoSlideStartCurrent:function(bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartCurrent();if(bRun){this.Run()}},GotoSlideStartRelative:function(iIndexSlideDiff,bySync){if(bySync==undefined){bySync=false}if(iIndexSlideDiff==-3){var a=0}if(0==iIndexSlideDiff){return}if(!bySync){this.bAutoJump=true}this.scriptManager.GotoSlideStartRelative(iIndexSlideDiff);this.Run()},GetCurrentSlideName:function(){return this.scriptManager.GetCurrentSlideName()},GotoSlideStartNo:function(iNo,bRun){if(bRun==undefined){bRun=true}this.scriptManager.GotoSlideStartNo(iNo);if(bRun){this.Run()}},SetCurrentSlideNo:function(iNo){this.scriptManager.GotoSlideStartNo(iNo)},GetSlideCount:function(){return this.scriptManager.GetSlideCount()},GetCurrentSlideNo:function(){return this.scriptManager.GetCurrentSlideNo()},GetArraySlideName:function(){return this.scriptManager.GetArraySlideName()},GetSlideIndex:function(sSlideName){return this.GetArraySlideName().indexOf(sSlideName)},GetNoSyncSlideViewCount:function(){var nVisit=0;for(i=0;i<this.visitArray.length;i++){nVisit+=(this.visitArray[i]==1)?1:0}return nVisit.toString()},GetSlideViewCount:function(){var nVisit=0;for(i=0;i<this.visitArray.length;i++){nVisit+=(this.visitArray[i]&1)?1:0}return nVisit.toString()},GetSlideViewStatus:function(){var strVisit="";for(i=0;i<this.visitArray.length;i++){strVisit+=(this.visitArray[i]&1)?"1":"0"}return strVisit},SetSlideViewStatus:function(sStatus){for(i=0;i<sStatus.length;i++){if(i<this.visitArray.length){this.visitArray[i]|=sStatus.charAt(i)=="1"?1:0}}},SetSlideViewStatus:function(sStatus){for(i=0;i<sStatus.length;i++){if(i<this.visitArray.length){this.visitArray[i]|=sStatus.charAt(i)=="1"?1:0}}},GetSlideProgressRate:function(){var t=0;var T=0;var v=0;var S=0;var s=0;t=this.videoManager.GetTotalMaxPlayTime();T=this.videoManager.GetTotalDurationTime();v=this.videoManager.GetTotalSyncSlideCount();S=this.GetSlideCount();s=parseInt(this.GetNoSyncSlideViewCount());if(S==0){S=1}if(T==0){T=1;t=0}var progress=t/T*v/S+s/S;if(progress>1){progress=1}return progress.toFixedOf(7)},RunMaster:function(sMasterName,x,y){if(x==undefined){x=0}if(y==undefined){y=0}this.masterManager.Run(sMasterName,x,y)},StopMaster:function(){this.bRunMaster=false;this.masterManager.Stop()},AddButton:function(iButtonID,sButtonName,rectangle,Normal,Over,Click,nButtonType,sSub,nActionType,sTooltip,sFontMacro,soundAsset,nKeepAlive,format,nQuizInfoIndex,nQuizChoiceNo,nIconFunction,nSoundVolume,iSoundLoop,iBitmapID,iDisappearGroupID,sID,nOverAction,sOverSub,nOutAction,sOutSub){this.mouseManager.AddButton(iButtonID,sButtonName,rectangle,Normal,Over,Click,nButtonType,sSub,nActionType,sTooltip,sFontMacro,soundAsset,nKeepAlive,format,nQuizInfoIndex,nQuizChoiceNo,nIconFunction,nSoundVolume,iSoundLoop,iBitmapID,iDisappearGroupID,sID,nOverAction||0,sOverSub||"",nOutAction||0,sOutSub||"")},GetButtonInfo:function(iButtonID){return this.mouseManager.GetButtonInfo(iButtonID)},FindButtonNo:function(sID){return this.mouseManager.FindButtonNo(sID)},GetFreeButtonNo:function(iButtonID){return this.mouseManager.GetFreeButtonNo(iButtonID)},AddHyperLink:function(rectangle,sHyperLink,sToolTip,sTarget){this.mouseManager.AddHyperLink(rectangle,sHyperLink,sToolTip,sTarget)},RedrawButtonAll:function(){this.mouseManager.RedrawAll()},SetEnableAll:function(bEnabled){this.mouseManager.SetEnableAll(bEnabled)},SetEnableGeneral:function(bEnabled){this.mouseManager.SetEnableGeneral(bEnabled)},SetEnableProgress:function(bEnabled){this.mouseManager.SetEnableProgress(bEnabled)},SetEnableKeepAlive:function(bEnabled){this.mouseManager.SetEnableKeepAlive(bEnabled)},SetEnable:function(iButtonNo,bEnabled){this.mouseManager.SetEnable(iButtonNo,bEnabled)},RemoveAll:function(){this.mouseManager.ClearAll();this.mouseManager.RemoveAll()},RemoveGeneral:function(){this.mouseManager.ClearGeneral();this.mouseManager.RemoveGeneral()},RemoveProgress:function(){this.mouseManager.ClearProgress();this.mouseManager.RemoveProgress()},RemoveKeepAlive:function(){this.mouseManager.ClearKeepAlive();this.mouseManager.RemoveKeepAlive()},Remove:function(iButtonNo){this.mouseManager.Clear(iButtonNo);this.mouseManager.Remove(iButtonNo)},StopButtonSound:function(){this.mouseManager.StopSound()},StopSoundButton:function(){this.mouseManager.StopSoundButton()},StopButtonSoundExcept:function(iButtonNo){this.mouseManager.StopSoundExcept(iButtonNo)},StopPreSoundIcon:function(iButtonNo){this.mouseManager.StopPreSoundIcon(iButtonNo)},RemoveSameDisappearGroupButton:function(iDisappearGroupNumber){},VideoAdd:function(object,iVideoID,sFile,rectangle,iDisplayType,bControlBar,arraySyncTime,iSyncType,sSlideNameStart,sSlideNameKeep,bCannotMoveToNeverSeen,sVideoID,bSyncObject){var bIsExist=true;var bPlayingNoSyncVideo=false;if(this.videoManager.Exists(iVideoID)==false){this.videoManager.Add(object,iVideoID,sFile,rectangle,iDisplayType,bControlBar,arraySyncTime,iSyncType,sSlideNameStart,sSlideNameKeep,bCannotMoveToNeverSeen,sVideoID,bSyncObject);bIsExist=false;this.SetCantMoveForward(iVideoID,bCannotMoveToNeverSeen)}else{var videoInfo=this.videoManager.GetVideoInfo(iVideoID);if(!videoInfo.IsSyncVideo()&&videoInfo.GetVisible()&&videoInfo.sSlideNameKeep!=""&&!videoInfo.IsNewVideo()){return}videoInfo.reset(iVideoID,sFile,rectangle,iDisplayType,bControlBar,arraySyncTime,iSyncType,sSlideNameStart,sSlideNameKeep,bCannotMoveToNeverSeen);bPlayingNoSyncVideo=!videoInfo.IsSyncVideo()&&videoInfo.GetVisible()}switch(iDisplayType){case 0:this.VideoClose(iVideoID);return;case 1:this.VideoAutoPlay(iVideoID,false);this.VideoShow(iVideoID);this.VideoVolume(iVideoID,500);this.VideoPause(iVideoID);return;case 4:this.VideoResetWaitUntilFinish(iVideoID);case 2:case 5:this.VideoAutoPlay(iVideoID,true);this.VideoShow(iVideoID);this.VideoVolume(iVideoID,500);this.VideoPlay(iVideoID);if(bPlayingNoSyncVideo){this.SetVideoPlayHeadTime(iVideoID,0)}return;case 3:this.VideoAutoPlay(iVideoID,true);this.VideoShow(iVideoID,false);this.VideoVolume(iVideoID,500);this.VideoPlay(iVideoID);return}},IsNewVideo:function(iVideoID){return this.videoManager.IsNewVideo(iVideoID)},VideoShow:function(iVideoID,bPlay){if(bPlay==undefined){bPlay=false}this.videoManager.Show(iVideoID,bPlay)},VideoHide:function(iVideoID,bClose){if(bClose==undefined){bClose=true}this.videoManager.Hide(iVideoID,bClose)},VideoResume:function(iVideoID){this.videoManager.Resume(iVideoID)},VideoPlay:function(iVideoID){if(Viewer.isAnApp||Viewer.isIOS){setTimeout("main.videoManager.Play("+iVideoID+")",100)}else{this.videoManager.Play(iVideoID)}},VideoPause:function(iVideoID){this.videoManager.Pause(iVideoID)},VideoVolume:function(iVideoID,iVolume){this.videoManager.setVolume(iVideoID,iVolume)},GetVideoVolume:function(iVideoID){return this.videoManager.GetVolume(iVideoID)},VideoLoop:function(iVideoID,iLoop){this.videoManager.Loop(iVideoID,iLoop)},VideoStop:function(iVideoID){this.videoManager.Stop(iVideoID)},VideoClose:function(iVideoID){this.videoManager.Close(iVideoID)},VideoDelete:function(iVideoID){this.videoManager.Close(iVideoID);this.videoManager.Delete(iVideoID)},VideoAutoPlay:function(iVideoID,bAutoPlay){this.videoManager.AutoPlay(iVideoID,bAutoPlay)},VideoAutoRewind:function(iVideoID,bAutoRewind){this.videoManager.AutoRewind(iVideoID,bAutoRewind)},VideoResetWaitUntilFinish:function(iVideoID){this.videoManager.ResetWaitUntilFinish(iVideoID)},SetFullScreenClicked:function(iVideoID,bSet){this.videoManager.SetFullScreenClicked(iVideoID,bSet)},GetFreeVideoNo:function(iVideoID){while(1){if(false==this.videoManager.Exists(iVideoID)){break}iVideoID++}return iVideoID},IsExistVideo:function(iVideoID){return this.videoManager.Exists(iVideoID)},FindVideoNo:function(sVideoID,bAll){if(bAll==undefined){bAll=true}return this.videoManager.FindVideoNo(sVideoID,bAll)},GetVideoName:function(iVideoNo){return this.videoManager.GetVideoName(iVideoNo)},FindFirstVideoNo:function(){return this.videoManager.FindFirstVideoNo()},FindVideo:function(sFile){return this.videoManager.FindVideo(sFile)},SetVideoPlayHeadTime:function(iVideoID,iPlayHeadTime){this.videoManager.PlayHeadTime(iVideoID,iPlayHeadTime)},SetVideoPlayHeadTime4IOS:function(iVideoID,iPlayHeadTime){this.videoManager.PlayHeadTime(iVideoID,iPlayHeadTime);this.videoManager.Play(iVideoID)},GetVideoPlayHeadTime:function(iVideoID){return this.videoManager.GetPlayHeadTime(iVideoID)},GetMute:function(iVideoID){return this.videoManager.GetMute(iVideoID)},SetMute:function(iVideoID,bMute){this.videoManager.SetMute(iVideoID,bMute)},SetCantMoveForward:function(iVideoID,bCantMove){this.videoManager.SetCantMoveForward(iVideoID,bCantMove)},SetMaxPlayTime:function(iVideoID,nPlayTime){this.videoManager.SetMaxPlayTime(iVideoID,nPlayTime)},SetPlayRate:function(iVideoID,nPlayRate){this.videoManager.SetPlayRate(iVideoID,nPlayRate)},VideoStopSyncTime:function(){this.videoManager.StopSyncTime()},VideoSetSyncTime:function(){this.videoManager.SetSyncTime()},VideoEnableControl:function(bControl){this.videoManager.EnableControl(bControl)},SetStopType:function(stopType){this.stopType=stopType},CanContinueWithMouse:function(){if(null==this.stopType){return true}return this.stopType.CanContinueWithMouse()},AddEBoard:function(iID,arrayEBoardAction,iControlPanelType,pointControlPanel,iShiftTime,MediaFile,iVideoControlPannel,rectangleVideo,iPlayLoop,sID){this.eboardManager.Add(iID,arrayEBoardAction,iControlPanelType,pointControlPanel,iShiftTime,MediaFile,iVideoControlPannel,rectangleVideo,iPlayLoop,sID)},FindEBoard:function(iID){return this.eboardManager.GetEBoardInfo(iID)},FindEBoardNo:function(sID){return this.eboardManager.FindEBoardNo(sID)},GetFreeEBoardNo:function(iID){while(1){if(false==this.eboardManager.Exists(iID)){break}iID++}return iID},ClearEBoard:function(){this.eboardManager.ClearEBoard()},CloseEBoard:function(){var panel=document.getElementById("eBoardControlPanel");if(panel){this.frontBuffer.HideEBoardControlPanel()}this.eboardManager.Close()},DrawEBoardItem:function(bitmapDrawable,sID){this.frontBuffer.DrawEBoardItem(bitmapDrawable,sID)},ClearEBoardItem:function(){this.frontBuffer.ClearEBoardItem()},AddEBoardControlPanel:function(bitmapDrawable){this.frontBuffer.AddEBoardControlPanel(bitmapDrawable)},ShowEBoardControlPanel:function(){this.frontBuffer.ShowEBoardControlPanel()},HideEBoardControlPanel:function(){this.frontBuffer.HideEBoardControlPanel()},PauseAllMedia:function(){this.videoManager.PauseAll();SOUND.prototype.Pause();this.globalPause=true},ResumeAllMedia:function(){this.videoManager.ResumeAll();SOUND.prototype.Resume();this.globalPause=false},FindBrowserNo:function(sID){return this.browserManager.FindBrowserNo(sID)},GetFreeBrowserNo:function(iID){return this.browserManager.GetFreeBrowserNo(iID)},AddBitmapClose:function(rectangle,iID,sID,sCommandID){if(sCommandID==undefined){sCommandID=""}this.bitmapManager.AddBitmapClose(rectangle,iID,sID,sCommandID)},AddBitmapSync:function(rectangle,iIndex,sID,sCommandID){if(sCommandID==undefined){sCommandID=""}},AddObjectSync:function(sCommandID,sID,iIndex,iInTime,iOutTime,nData,sMasterName){iInTime=iInTime||-1;iOutTime=iOutTime||Number.MAX_VALUE;nData=nData||-1;this.objectSyncManager.AddObjectSync(sCommandID,sID,iIndex,iInTime,iOutTime,nData,sMasterName)},DeleteObjectSync:function(){this.objectSyncManager.SlideStart()},GetCurrentSyncObjectTime:function(){if(this.nVideoNoSyncObject>=0){return this.GetVideoPlayHeadTime(this.nVideoNoSyncObject)*1000}return this.getTimer()-this.nSlideStartTime+this.nSlideStartTimeStart},GetScriptIndex:function(){return this.scriptManager.GetScriptIndex()},FindVideoSyncObject:function(){var bSyncObjectVideo=false;var iScriptIndex=this.scriptManager.GetScriptIndex();for(var i=iScriptIndex;i<this.scriptManager.ScriptCount();i++){var script=this.scriptManager.GetScript(i);if(script instanceof SLIDEEND){break}if(script instanceof VIDEOOPEN){var videoopen=script;if(videoopen.IsSyncObjectVideo()){bSyncObjectVideo=true;break}}}return bSyncObjectVideo},IsRunScript:function(){return !(this.scriptManager.GetScript(this.GetScriptIndex()-1) instanceof SLIDEEND)},ShowWindowTextArea:function(bShow){for(var i=0;i<this.textAreaArray.length;i++){var textArea=this.textAreaArray[i];if(textArea){if(bShow){this.Draw(textArea)}else{this.Clear(textArea)}}}},DeleteAllTextArea:function(){for(var i=0;i<this.textAreaArray.length;i++){var textArea=this.textAreaArray[i];if(textArea){if(this.Contains(textArea.divShape)){this.Clear(textArea)}}}this.textAreaArray=[];this.textAreaIDArray=[]},AddTextArea:function(textArea,sID){this.textAreaArray.push(textArea);this.textAreaIDArray.push(sID)},FindTextArea:function(sID){var textArea;for(var i=0;i<this.textAreaIDArray.length;i++){if(this.textAreaIDArray[i].toString()==sID){textArea=this.textAreaArray[i];return textArea}}return null},Contains:function(item){return this.frontBuffer.Contains(item)},Delete:function(id,bAll){if(id&&id!=-1){var item=document.getElementsByClassName("item image shape "+id);if(bAll){for(var i=0;i<item.length;i++){this.frontBuffer.Clear(item[i]);i--}}else{if(item.length==1){this.frontBuffer.Clear(item[0])}}}},Exist:function(id){if(id&&id>0){if(document.getElementsByClassName("item image shape "+id).length>0){return true}}return false},getTimer:function(){return new Date().getTime()-this.nSildeRunTime},ShowWaterMark:function(){this.frontBuffer.ShowWaterMark()},GetAutoObjectNo:function(){return String(this.nAutoObjectNo++)},AddBitmapCloseButton:function(shape,sID,iButtonNo,disappearGroupID){if(disappearGroupID>0){sID="G"+disappearGroupID;shape.setID(sID);iButtonNo=disappearGroupID}var rectangle=new Rectangle(shape.divShape.offsetLeft,shape.divShape.offsetTop,shape.divShape.offsetWidth,shape.divShape.offsetHeight);this.AddButton(iButtonNo,"",rectangle,-1,-1,-1,2,sID,24,"","",null,2,null,-1,-1,-1,-1,-1,-1,-1)},RemoveBitmapClose:function(bitmapDrawable,iButtonNo,disappearGroupID){if(disappearGroupID>0){this.Delete("G"+disappearGroupID,true);iButtonNo=disappearGroupID}else{this.frontBuffer.Clear(bitmapDrawable)}this.mouseManager.Remove(iButtonNo)},ShowNotSupportedMessage:function(){jAlert("this function is not supported on this device","",1)}};return Main});