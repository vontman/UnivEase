define("CVideoInfo",["CVideoPlayer","CAssertUtil"],function(a,c){function b(h,r,n,q,o,s,p,j,k,d,g,m,u,f,t,e){this.object=h;this.iVideoID=r;this.sVideoID=t||"";this.sFile=n;this.rectangle=q;this.iDisplayType=o;this.bControlBar=s;this.arraySyncTime=p;this.iSyncType=j==0?0:j||2;this.sSlideNameStart=k||"";this.sSlideNameKeep=d||"";this.bCannotMoveToNeverSeen=g||false;this.iPlayheadTimeSeen=0;this.alreadySyncTime=[];for(var l=0;l<this.arraySyncTime.length;l++){this.alreadySyncTime.push(false)}this.bSyncObject=e||false;this.videoPlayer;this.nMuteVolume=-1;this.bHide=true;this.bNewVideo=true;this.iJumpTime=0;this.timer=null;this.nSyncTime=0;this.bSyncMoving=false}b.prototype={reset:function(l,h,k,i,m,j,f,g,d,e){if(h!=this.sFile){this.sFile=h;this.videoPlayer.sSource=this.sFile;if(this.videoPlayer.videoDisplay){this.videoPlayer.videoDisplay.currentSrc=this.sFile}}if(k!=this.rectangle){this.videoPlayer.x=k.x;this.videoPlayer.y=k.y;this.videoPlayer.width=k.width;this.videoPlayer.height=k.height;this.rectangle=k}if(i!=this.iDisplayType){this.iDisplayType=i;this.videoPlayer.iPlayType=this.iDisplayType;this.videoPlayer.iLoop=this.iDisplayType==3?1:0}if(m!=this.bControlBar){this.bControlBar=m;this.videoPlayer.bControlBarVisible=this.bControlBar}if(j!=this.arraySyncTime){this.arraySyncTime=j;if(this.arraySyncTime.length>0){this.videoPlayer.videoDisplay.addEventListener("timeupdate",this.videoPlayer_PlayheadUpdate)}}if(f!=this.iSyncType){this.iSyncType=f}if(g!=this.sSlideNameStart){this.sSlideNameStart=g}if(d!=this.sSlideNameKeep){this.sSlideNameKeep=d}if(e!=this.bCannotMoveToNeverSeen){this.bCannotMoveToNeverSeen=e}this.videoPlayer.OnLoadComplete()},GetVideoDisplay:function(){if(null==this.videoPlayer){this.videoPlayer=new a(this.object);this.videoPlayer.bAutoPlay=false;this.videoPlayer.sSource=this.sFile;this.videoPlayer.x=this.rectangle.x;this.videoPlayer.y=this.rectangle.y;this.videoPlayer.width=this.rectangle.width;this.videoPlayer.height=this.rectangle.height;this.videoPlayer.bControlBarVisible=this.bControlBar;this.videoPlayer.iPlayType=this.iDisplayType;this.videoPlayer.iLoop=this.iDisplayType==3?1:0;this.videoPlayer.videoDisplay.parentClass=this;if(this.arraySyncTime.length>0){this.videoPlayer.videoDisplay.addEventListener("timeupdate",this.videoPlayer_PlayheadUpdate)}this.videoPlayer.OnCreationComplete();if(this.sVideoID){this.videoPlayer.divDisplay.className=this.videoPlayer.divDisplay.className+" "+this.sVideoID}}return this.videoPlayer},videoPlayer_PlayheadUpdate:function(d){if(this.parentClass.bSyncMoving){return}if(this.parentClass.iSyncType==1){return}if(this.parentClass.bHide){return}if(d.target.seeking){this.parentClass.ClearAlreadySyncTime()}if(d.target.rewinding){this.parentClass.ClearAlreadySyncTime();return}if(d.target.currentTime*1000<=this.parentClass.iJumpTime){return}else{this.parentClass.iJumpTime=0}var i=d.target.currentTime*1000+1;var h=main.GetSlideIndex(this.parentClass.sSlideNameStart);var g=this.parentClass.GetIndexSyncTime(i);if(this.parentClass.iPlayheadTimeSeen<i){this.parentClass.iPlayheadTimeSeen=i}var f=h+g+1;var e=main.GetCurrentSlideNo()-1;if(f==e){this.parentClass.alreadySyncTime[g+1]=true;return}if(this.parentClass.iSyncType==0&&this.parentClass.alreadySyncTime[g+1]){return}main.GotoSlideStartRelative(f-e);this.parentClass.alreadySyncTime[g+1]=true},GetIndexSyncTime:function(d){for(var e=this.arraySyncTime.length-1;0<=e;e--){if(this.arraySyncTime[e]<d){return e}}return -1},CanStay:function(g){if(this.sSlideNameKeep==""){return this.sSlideNameStart==g}var f=main.GetSlideIndex(this.sSlideNameStart);var d=main.nCurrentSlideNo-1;var e=main.GetSlideIndex(this.sSlideNameKeep);if((f<=d)&&(d<=e)){return true}return false},Synchronize:function(k){if(main.Contains(this.videoPlayer)==false){return}var i=main.GetSlideIndex(this.sSlideNameStart);var h=main.GetCurrentSlideNo()-1;var d=h-i;var g=0;if(0!=d){g=this.arraySyncTime[d-1]}var f=this.sFile.substr(0,5).toLowerCase()=="rtmp:";if(f||!this.videoPlayer.videoDisplay.paused){if(Viewer.isIOS){try{this.videoPlayer.setPlayheadTime(g/1000)}catch(j){this.videoPlayer.videoDisplay.pause();setTimeout("main.SetVideoPlayHeadTime4IOS("+this.iVideoID+", "+(g/1000)+")",2000)}}else{this.videoPlayer.setPlayheadTime(g/1000)}this.iJumpTime=g}else{this.nSyncTime=g/1000;this.videoPlayer.setPlayheadTime(g/1000);this.videoPlayer.Play()}},AutoPlay:function(d){var e=this.GetVideoDisplay();e.bAutoPlay=d},AutoRewind:function(e){var d=this.GetVideoDisplay();d.AutoRewind=e},ResetWaitUntilFinish:function(){var d=this.GetVideoDisplay();d.bWaitUntilFinish=false},GetVisible:function(){var d=this.GetVideoDisplay();if(main.Contains(d.divDisplay)){return true}return false},SetVisible:function(d){if(d){var e=this.bHide;this.Show(true);if(e){this.Resume();if(this.bSyncObject){main.nVideoNoSyncObject=this.iVideoID;if(!main.bSyncObjectTimer){main.ObjectSyncManager().SetTimer()}}}}else{if(this.IsNewVideo()||this.bSyncObject||this.IsSyncVideo()){this.Hide()}}},Show:function(f){if(f==undefined){f=false}var d=this.GetVideoDisplay();if(false==main.Contains(d.divDisplay)){if(d.divDisplay.childElementCount==0){d.SetDisplay()}main.Draw(d);this.bHide=false}if(f){d.Play()}var e=Viewer.isFireFox?1.00001:1;this.SetPlayRate(1);main.nLastVideoNo=this.iVideoID},Hide:function(e){if(e==undefined){e=true}var d=this.GetVideoDisplay();if(main.Contains(d.divDisplay)){this.bHide=true;if(e){d.Close();main.Clear(d);if(Viewer.isIOS&&this.object&&this.object.renew){this.object.renew();this.videoPlayer=null;this.videoPlayer=this.GetVideoDisplay()}}else{d.Pause()}}},Play:function(){var d=this.GetVideoDisplay();d.Play()},Resume:function(){var d=this.GetVideoDisplay();d.Play()},Pause:function(){var d=this.GetVideoDisplay();d.Pause()},Loop:function(d){var e=this.GetVideoDisplay();e.iLoop=d},Stop:function(){var d=this.GetVideoDisplay();d.Stop()},setVolume:function(d){var e=this.GetVideoDisplay();e.setVolume(d/1000)},GetVolume:function(){var d=this.GetVideoDisplay();return d.getVolume()},PlayHeadTime:function(d){var e=this.GetVideoDisplay();e.setPlayheadTime(d)},GetPlayHeadTime:function(){var d=this.GetVideoDisplay();return d.GetPlayheadTime()},SetMute:function(e){var d=this.GetVideoDisplay();if(e==undefined){d.videoDisplay.muted=!d.videoDisplay.muted}else{d.videoDisplay.muted=e}},SlideStart:function(e){var d=this.CanStay(e);this.bNewVideo=!d;this.bSyncMoving=d&&this.IsSyncVideo()&&this.iSyncType>=1&&!main.bAutoJump;if(!d){this.SetVisible(d)}if(d&&this.sSlideNameKeep!=""&&this.sSlideNameStart!=e){if(this.bHide){this.SetVisible(d)}else{if(this.videoPlayer.videoDisplay){if(this.videoPlayer.videoDisplay.paused){if(this.IsNewVideo()){this.Play()}}}}}if(d&&!this.bHide&&this.sSlideNameStart==e){this.SetVisible(main.bAutoJump);this.bSyncMoving=false}else{if(this.bSyncMoving){this.bSyncMoving=false;this.Synchronize(e)}}return d},IsNewVideo:function(){return this.bNewVideo},SetCantMoveForward:function(e){var d=this.GetVideoDisplay();d.setCanMoveForward(e)},SetMaxPlayTime:function(d){var e=this.GetVideoDisplay();e.nMaxPlayTime=d},GetMaxPlayTime:function(){var d=this.GetVideoDisplay();return d.nMaxPlayTime},SetPlayRate:function(e){var d=this.GetVideoDisplay();d.videoDisplay.playbackRate=e;if(Viewer.isIOS&&!d.videoDisplay.paused){d.Pause();d.Play()}},SetFullScreenClicked:function(e){var d=this.GetVideoDisplay();if(d.videoDisplay.webkitRequestFullScreen){d.videoDisplay.webkitRequestFullScreen()}if(d.videoDisplay.mozRequestFullScreen){d.videoDisplay.mozRequestFullScreen()}if(d.videoDisplay.webkitEnterFullScreen){d.videoDisplay.webkitEnterFullScreen()}},getSyncType:function(){return this.iSyncType},IsSyncVideo:function(){return this.arraySyncTime.length>0},ClearAlreadySyncTime:function(){for(var d=0;d<this.arraySyncTime.length;d++){this.alreadySyncTime[d]=false}},StopSyncTime:function(){if(this.arraySyncTime.length>0){this.videoPlayer.videoDisplay.removeEventListener("timeupdate",this.videoPlayer_PlayheadUpdate,false)}},SetSyncTime:function(){if(this.arraySyncTime.length>0){this.videoPlayer.videoDisplay.addEventListener("timeupdate",this.videoPlayer_PlayheadUpdate);if(this.videoPlayer.videoDisplay.paused){main.GotoSlideStart(this.sSlideNameKeep);this.videoPlayer.Stop()}}},EnableControl:function(d){if(d==undefined){d=true}this.videoPlayer.videoDisplay.controls=d}};return b});