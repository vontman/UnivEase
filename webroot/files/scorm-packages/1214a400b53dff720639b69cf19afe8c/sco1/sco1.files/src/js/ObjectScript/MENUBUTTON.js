define("MENUBUTTON",["CScript","CTextFormatUtil","Rectangle","CUIComponentFactory","CColorUtil"],function(c,b,d,a,f){function e(m,h,p,g,o,j,n,q,l,i,k,r){this.sID=m||"";this.x1=h;this.y1=p;this.x2=g;this.y2=o;this.iControlType=j||0;this.iControlStyle=n||0;this.sFontMacro=q||"";this.iCount=l||0;this.iInTime=i||-1;this.iOutTime=k||Number.MAX_VALUE;this.arg=Array.prototype.slice.call(arguments,11);this.format=b.parseFontMacro(q,"left","top",24);this.iSyncObject=0;this.iIndex=0;this.iID;this.aMenuName;this.aSlideName;this.sLabelData;this.control;this.list;this.bInit=false}e.prototype=new c();e.prototype.Init=function(){this.aMenuName=new Array();this.aSlideName=new Array();for(var g=0;g<this.iCount;g++){if(main.FindSlide(this.arg[g*2+1])){if(this.format.kerning==true){this.aMenuName.push(a.String2RTL(this.arg[g*2]))}else{this.aMenuName.push(this.arg[g*2])}this.aSlideName.push(this.arg[g*2+1])}}this.iCount=this.aMenuName.length;this.sLabelData=new Array;for(g=0;g<this.iCount;g++){this.sLabelData.push({label:this.aMenuName[g],data:this.aSlideName[g]})}this.bInit=true};e.prototype.Run=function(A){A=A||false;if(Viewer.isAndroid||Viewer.isIOS){this.iControlType=1}if(!this.bInit){this.Init()}if(this.iCount==0){return}var h=this.sID==null?"":this.sID.toString();if(typeof this.sID=="string"){this.iID=main.ControlManager().FindControlNo(h)}else{this.iID=Number(this.sID)}if(this.iID==-1){this.iID=main.ControlManager().GetFreeControlNo(0)}this.iSyncObject=this.CheckSyncObject(A,"MENUBUTTON",this.sID,this.iInTime,this.iOutTime);if(this.iScriptIndex>=0){this.iIndex=this.iScriptIndex}if(this.iSyncObject==-1){return}var x=main.GetCurrentSlideName();var u;var k;var s=false;for(var v=0;v<this.iCount;v++){if(this.aSlideName[v]==x){u=this.aMenuName[v];k=v;s=true;break}}if(!s){var o;var z;o=main.GetSlideIndex(x);for(v=o-1;v>=0;v--){z=main.GetArraySlideName()[v];for(var t=0;t<this.iCount;t++){if(this.aSlideName[t]==z){u=this.aMenuName[t];k=t;s=true;break}}if(s){break}}}var q,p,r;if(this.iControlType==0){q=this.arg.length>2?this.sLabelData.length+1:this.sLabelData.length;p=18;r="click"}else{if(this.iControlType==1){q=1;p=0;r="change"}}var w=document.createElement("div");w.className="item list";w.style.left=this.x1+"px";w.style.top=this.y1+"px";w.style.width=this.x2-this.x1+"px";w.style.height=this.y2-this.y1+"px";w.style.zIndex=(document.getElementById("imageCanvas").querySelectorAll(".item.list").length||0)+80000;if(this.sID){w.className=w.className+" "+this.sID}var n=document.createElement("select");n.className="content";n.style.width=this.x2-this.x1+p+"px";n.setAttribute("size",q);for(var v=0;v<this.sLabelData.length;v++){var y=document.createElement("option");y.setAttribute("value",this.sLabelData[v].data);y.innerText=this.sLabelData[v].label;n.appendChild(y)}n.selectedIndex=k;n.me=this;n.addEventListener(r,this.changeHandler);w.appendChild(n);this.list=w;this.control=n;main.Draw(w);this.control.style.color=f.RGBColor(this.format.color);if(this.iControlType==1){this.list.style.height=Number(this.format.size)+2+"px";this.list.style.overflow="hidden"}if(this.format.rightMargin==-1){}else{var m=Number(this.format.rightMargin);var l=new Array;l[0]=[m,m];if(this.iControlType==0){this.list.style.backgroundColor=f.RGBColor(m)}else{if(this.iControlType==1){this.control.style.backgroundColor=f.RGBColor(m)}}}this.control.style.fontFamily=this.format.font;this.control.style.fontSize=this.format.size+"px";if(this.format.italic){this.control.style.fontStyle="italic"}if(this.format.bold){this.control.style.fontWeight="bold"}switch(this.format.align){case"left":this.control.style.textAlign="left";break;case"right":this.control.style.textAlign="right";break;case"center":this.control.style.textAlign="center";break}if(this.format.underline){this.control.style.textDecoration="underline"}var g=main.ControlManager();g.AddControl(this.iID,this.iControlType,this.list,h);if(main.bFullScreen){main.ControlManager().ShowWindow(false)}};e.prototype.changeHandler=function(g){if(this.me.control.disabled){return}var h=this.me.aSlideName[this.me.control.selectedIndex];main.GotoSlideStart(h)};return e});