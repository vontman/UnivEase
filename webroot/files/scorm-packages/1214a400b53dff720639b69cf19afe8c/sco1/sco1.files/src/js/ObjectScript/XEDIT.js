define("XEDIT",["CScript","Rectangle","BitmapAsset","CStopTypeAfterNSec","CEffectMacro","AnimationPackage","Shape","TextArea","CColorUtil"],function(e,j,h,d,g,c,f,i,b){function a(y,t,F,o,E,m,w,s,z,l,r,D,k,B,x,p,q,v,u,A,C,n){this.oID=y||null;this.iOpenClose=t||1;this.iX1=F||0;this.iY1=o||0;this.iX2=E||-1;this.iY2=m||-1;this.iDataType=w||-1;this.iIsFile=s||1;this.TextObject=z==undefined?null:z;this.iEditMode=l||0;this.sEffectMacro=r||"";this.sFontMacro=D||"";this.sHyperLink=k||"";this.sHyperLinkToolTip=B||"";this.edgeImageBitmapAsset=x||null;this.iLayoutMode=p||0;this.iScrollBar=q||0;this.iMouseContextMenu=v||8192;this.edgeFormat=CTextFormatUtil.parseEdgeMacro(this.sFontMacro);this.format=CTextFormatUtil.parseFontMacro(this.sFontMacro);if(this.format.leading==null){this.format.leading=6.666666666666667}if(z instanceof h){this.bitmapAsset=z}this.disappear=u||0;this.disappearGroupID=A||-1;this.iInTime=C||-1;this.iOutTime=n||Number.MAX_VALUE;this.iSyncObject;this.iIndex;this.sID=this.oID==null?"":this.oID.toString();this.EM=new g();this.EM.parseEffectMacro(this.sEffectMacro);this.textArea=null;this.bEditMode=false}a.prototype=new e();a.prototype.StopType=function(){if(this.EM.IsAnimation()){return new d(0)}return null};a.prototype.onLoadComplete=function(l){var k=this.me;k.bitmapAsset=new h(k.Image);if(main.GetCurrentSlideNo()==k.iCurrentSlideNo){k.Display();k.Resume()}};a.prototype.onLoadError=function(l){var k=this.me;k.Resume()};a.prototype.Run=function(t){t=t||false;this.iID=Number(this.sID);var l=Number(this.edgeFormat.size);var u=(l+1)/2;var n=Number(this.edgeFormat.indent);var q=Number(this.format.rightMargin);var o=Number(this.edgeFormat.color);var v=new j(this.iX1,this.iY1,this.iX2-this.iX1,this.iY2-this.iY1);this.iSyncObject=this.CheckSyncObject(t,"XEDIT",this.sID,this.iInTime,this.iOutTime);if(this.iScriptIndex>=0){this.iIndex=this.iScriptIndex}if(this.iSyncObject==-1){return}if(typeof this.TextObject=="string"&&this.TextObject!=null){if(this.iEditMode!=0||this.iScrollBar!=0){this.bEditMode=true}}var r;if(this.bitmapAsset&&this.bitmapAsset.bitmapData){var w=this.bitmapDataTransparent?this.bitmapDataTransparent:this.bitmapAsset.bitmapData;r=new f(v.x,v.y,v.width,v.height);r.graphics.drawImage(w,n,n,(w.width||w.naturalWidth),(w.height||w.naturalHeight))}else{if(typeof this.TextObject=="string"&&this.TextObject!=null){if(this.bEditMode){this.AddTextArea(this.iX1+1,this.iY1+1,this.iX2-this.iX1-1,this.iY2-this.iY1-1);this.textArea.SetText(String(this.TextObject));if(this.iEditMode==2){this.textArea.editable(false)}r=this.textArea;main.AddTextArea(this.textArea,this.sID);if(main.bFullScreen){main.ShowWindowTextArea(false)}}else{r=new f(v.x,v.y,v.width,v.height);if(q!=-1){CUIComponentFactory.fillRectangle(r,0,0,v.width,v.height,q)}var k=new j(0,0,v.width,v.height);k.inflate(-n,-n);CUIComponentFactory.Text(r,String(this.TextObject),k,this.format)}}}if(!this.bEditMode){if(this.edgeImageBitmapAsset){v.inflate(u,u);var m=new f(v.x,v.y,v.width,v.height);m.graphics.drawImage(r.divCanvas,l,l);CUIComponentFactory.EdgeImageBox(this.iX1,this.iY1,this.iX2,this.iY2,l,this.edgeImageBitmapAsset,m);r=m}else{if(this.edgeFormat.size){if(this.edgeFormat.blockIndent==0){v.inflate(-u,-u);v.offset(-l,-l);var m=new f(v.x,v.y,v.width,v.height);m.graphics.drawImage(r.divCanvas,0,0);CUIComponentFactory.DrawRectangle3(m,this.edgeFormat.size,this.edgeFormat.color);r=m}else{if(Viewer.isIE){CUIComponentFactory.DrawRectangle3(r,1,this.edgeFormat.color,"dashed")}else{CUIComponentFactory.DrawRectangle4(r,1,this.edgeFormat.color,this.edgeFormat.blockIndent)}}}}}if(this.sID&&r){r.setID(this.sID)}main.Draw(r);if(this.bEditMode){if(this.iEditMode==0&&this.iScrollBar==1){if(this.textArea.divTextArea.scrollHeight<=this.textArea.divShape.scrollHeight){this.textArea.divTextArea.draggable=true;this.textArea.disable()}}}if(this.disappear==1){var s=main.GetFreeButtonNo(10000);main.AddBitmapCloseButton(r,this.sID,s,this.disappearGroupID);r.addStyle("cursor","pointer");r.addStyle("cursor","cursor");r.addEvent("onclick","main.RemoveBitmapClose(this, "+s+", "+this.disappearGroupID+")")}if(this.sHyperLink.length>0){r.addHyperLink(this.sHyperLink,this.sHyperLinkToolTip)}if(this.sEffectMacro.length>0){if(this.EM.IsAnimation()){if(!this.sID){r.setID("E"+r.zIndex)}var p=new c(r.divShape);p.setmacro(this.sEffectMacro.split(","));p.setcontainer();p.start()}}};a.prototype.AddTextArea=function(k,n,l,m){this.textArea=new i();this.textArea.SetWidth(l);this.textArea.SetHeight(m);this.textArea.move(k,n);this.textArea.setStyle("color",b.RGBColor(Number(this.format.color)));this.textArea.setStyle("fontFamily",this.format.font);this.textArea.setStyle("textAlign",this.format.align);if(this.format.rightMargin>0){this.textArea.setStyle("backgroundColor",b.RGBColor(Number(this.format.rightMargin)))}if(this.format.bold==true){this.textArea.setStyle("fontWeight","bold")}if(this.format.italic==true){this.textArea.setStyle("fontStyle","italic")}if(this.format.size>0){this.textArea.setStyle("fontSize",this.format.size+"px")}if(this.format.underline==true){this.textArea.setStyle("textDecoration","underline")}if(this.edgeFormat.size){if(this.edgeFormat.blockIndent==0){this.textArea.setStyle("borderWidth",Number(this.edgeFormat.size)+"px");this.textArea.setStyle("borderStyle","solid");this.textArea.setStyle("borderColor",b.RGBColor(Number(this.edgeFormat.color)))}else{this.textArea.setStyle("borderWidth",Number(this.edgeFormat.size)+"px");this.textArea.setStyle("borderStyle","dashed");this.textArea.setStyle("borderColor",b.RGBColor(Number(this.edgeFormat.color)))}}};return a});