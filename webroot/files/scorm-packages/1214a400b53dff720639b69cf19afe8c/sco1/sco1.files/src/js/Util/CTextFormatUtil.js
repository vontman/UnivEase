define("CTextFormatUtil",["TextFormat","TextField","Point","Capabilities"],function(c,b,d,a){CTextFormatUtil={parseFontMacro:function(j,f,g,i){f=f||"left";g=g||"top";i=i||12;var k=new c();var e,l;var h;if(!j){return k}k.align=f;k.color="000000";k.size=i;k.target=g;k.rightMargin=-1;k.kerning=false;e=j.indexOf("^A");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.align="left";break;case 1:k.align="right";break;case 2:k.align="center";break}}e=j.indexOf("^B");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.bold=null;break;case 1:k.bold=true;break}}e=j.indexOf("^CRGB(");if(e>-1){h=parseInt(j.substring(e+6));h=((h&16711680)>>16)|(h&65280)|((h&255)<<16)|(h&4278190080);k.color=h;e=j.indexOf(",",e+6);if(e>-1){if(j.substring(e+1,e+1+3)=="RGB"){h=parseInt(j.substring(e+5));h=((h&16711680)>>16)|(h&65280)|((h&255)<<16)|(h&4278190080)}else{h=parseInt(j.substring(e+1))}k.rightMargin=h}}e=j.indexOf("^I");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.italic=null;break;case 1:k.italic=true;break}}e=j.indexOf("^M");if(e>-1){l=j.indexOf(",",e);k.font=j.substring(e+2,l)}e=j.indexOf("^S");if(e>-1){h=parseInt(j.substring(e+2));k.size=h}e=j.indexOf("^T");if(e>-1){h=parseInt(j.substring(e+2));k.size=h*96/72}e=j.indexOf("^Y");if(e>-1){h=parseInt(j.substring(e+2));k.leading=h}e=j.indexOf("^Z");if(e>-1){h=parseInt(j.substring(e+2));k.leading=h*96/72}e=j.indexOf("^U");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.underline=null;break;case 1:k.underline=true;break}}e=j.indexOf("^O");if(e>-1){h=parseInt(j.substring(e+2));k.bullet=h;e=j.indexOf(",",e+2);if(e>-1){if(j.substring(e+1,e+1+3)=="RGB"){h=parseInt(j.substring(e+5));h=((h&16711680)>>16)|(h&65280)|((h&255)<<16)|(h&4278190080);if(k.bullet){k.color=h}}}}e=j.indexOf("^V");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.target="top";break;case 1:k.target="bottom";break;case 2:k.target="center";break}}e=j.indexOf("^L");if(e>-1){h=parseInt(j.substring(e+2));switch(h){case 0:k.kerning=false;break;case 1:k.kerning=true;break}}if(k.font==null){k.font=a.Message(a.Langueges.FontMacro)}return k},parseEdgeMacro:function(g){var h=new c();var e;var f;h.indent=0;h.size=0;h.color=0;h.blockIndent=0;h.kerning=false;e=g.indexOf("^E");if(e>-1){h.indent=parseInt(g.substring(e+2));e=g.indexOf(",",e+2);h.size=parseInt(g.substring(e+1));e=g.indexOf("RGB(",e+1);f=parseInt(g.substring(e+4));f=((f&16711680)>>16)|(f&65280)|((f&255)<<16)|(f&4278190080);h.color=f;e=g.indexOf(",",e+4);h.blockIndent=parseInt(g.substring(e+1))}return h},GetSlideNumberWidth:function(n,l,h){var m;var f;var g=new b();var e=n.toString().length;var k="";for(var j=1;j<=e;j++){k+="4"}f=k+"/"+k;g.text=f;g.setTextFormat(l);m=g.textWidth+4*e;if(h>0&&m<h){m=h}return m},GetFontPointSize:function(i,h,g){var e=new d();var f=new b();f.text=g;f.setTextFormat(h);e.x=f.textWidth;e.y=f.textHeight;return e}};return CTextFormatUtil});