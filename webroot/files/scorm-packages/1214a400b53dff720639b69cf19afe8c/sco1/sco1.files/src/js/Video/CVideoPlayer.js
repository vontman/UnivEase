define("CVideoPlayer",function(){function a(b){this.videoDisplay=b.videoData||b.soundData;this.sSource;this.bAutoPlay;this.bControlBarVisible;this.bCantMoveForward;this.nMaxPlayTime=0;this.iPlayType=2;this.iLoop=0;this.bFullScreenClicked=false;this.sInitState="";this.iInitStartTime=-1;this.nInitVolume=0.5;this.bIsDragging;this.timer=null;this.eboardInfo=null;this.bWaitUntilFinish=false;this.currentTime=0;this.playedTime=0}a.prototype={GetPlayheadTime:function(){return this.videoDisplay.currentTime},setPlayheadTime:function(b){if(this.videoDisplay.currentSrc){if(this.videoDisplay.currentTime!=undefined){this.videoDisplay.currentTime=b;if(main.nLastPlayTime!=-1){this.videoDisplay.currentTime=main.nLastPlayTime;main.nLastPlayTime=-1}if(main.nMaxPlayedTime!=-1){this.playedTime=main.nMaxPlayedTime;main.nMaxPlayedTime=-1}}}else{this.iInitStartTime=b}},setVolume:function(b){this.videoDisplay.volume=b;if(!this.videoDisplay.currentSrc){this.nInitVolume=b}},getVolume:function(){return this.videoDisplay.volume},setCanMoveForward:function(b){this.bCantMoveForward=b},SetDisplay:function(){this.divDisplay.appendChild(this.videoDisplay)},OnLoadComplete:function(){this.videoDisplay.autoPlay=this.bAutoPlay;if(this.bAutoPlay==false){this.videoDisplay.pause()}this.videoDisplay.controls=this.bControlBarVisible;this.divDisplay.style.left=this.x+"px";this.divDisplay.style.top=this.y+"px";this.divDisplay.style.width=this.width+"px";this.divDisplay.style.height=this.height+"px";this.videoDisplay.style.width=this.width+"px";this.videoDisplay.style.height=this.height+"px";this.divDisplay.appendChild(this.videoDisplay);switch(this.sInitState){case"Play":this.Play();break;case"Pause":this.Pause();break;case"Stop":this.Stop();break;case"Close":this.Close();return}if(this.iInitStartTime>-1){this.setPlayheadTime(this.iInitStartTime)}this.setVolume(this.nInitVolume)},OnCreationComplete:function(){this.videoDisplay.autoPlay=this.bAutoPlay;if(this.bAutoPlay==false){this.videoDisplay.pause()}this.videoDisplay.controls=this.bControlBarVisible;this.divDisplay=document.createElement("div");this.divDisplay.className="item video";this.divDisplay.style.left=this.x+"px";this.divDisplay.style.top=this.y+"px";this.divDisplay.style.width=this.width+"px";this.divDisplay.style.height=this.height+"px";this.videoDisplay.style.width=this.width+"px";this.videoDisplay.style.height=this.height+"px";this.zIndex=document.getElementById("imageCanvas").querySelectorAll(".item.video").length||0;this.divDisplay.style.zIndex=this.zIndex+90000;if(this.videoDisplay.localName=="audio"){if(Viewer.isIE){this.divDisplay.style.height="38px";this.videoDisplay.style.height="45px";if(this.width<273){this.videoDisplay.style.width="273px"}}else{this.divDisplay.style.height="32px";this.videoDisplay.style.height="32px"}}if(this.width<=0||this.height<=0){this.divDisplay.style.display="none"}this.videoDisplay.me=this;this.videoDisplay.addEventListener("timeupdate",this.videoDisplay_playheadUpdate);this.videoDisplay.addEventListener("seeking",this.hsliderTimeline_change);this.videoDisplay.addEventListener("ended",this.videoDisplay_complete);this.divDisplay.appendChild(this.videoDisplay);switch(this.sInitState){case"Play":this.Play();break;case"Pause":this.Pause();break;case"Stop":this.Stop();break;case"Close":this.Close();return}if(this.iInitStartTime>-1){this.setPlayheadTime(this.iInitStartTime)}this.setVolume(this.nInitVolume)},Play:function(){if(!this.bClosed){if(this.videoDisplay.currentSrc||this.videoDisplay.src||(this.videoDisplay.document&&this.videoDisplay.document.readyState=="complete")){this.videoDisplay.play();this.videoDisplay.focus()}else{this.sInitState="Play"}}},Stop:function(){if(this.videoDisplay.currentSrc){this.videoDisplay.pause();if(this.videoDisplay.currentTime){this.videoDisplay.currentTime=0}}else{this.sInitState="Stop"}},Pause:function(){if(this.videoDisplay.currentSrc){this.videoDisplay.pause()}else{this.sInitState="Pause"}},Close:function(){if(this.videoDisplay&&this.videoDisplay.currentSrc){this.videoDisplay.pause();if(this.videoDisplay.currentTime){this.videoDisplay.currentTime=0}}else{this.sInitState="Close"}},videoDisplay_playheadUpdate:function(b){if(b.target.seeking){return}if(!this.me.bIsDragging){var d=b.currentTarget.currentTime;var c=b.currentTarget.duration;this.me.currentTime=d;if(c<(d+0.5)){this.me.playedTime=c}else{if(this.me.playedTime<d){this.me.playedTime=d}}}},videoDisplay_complete:function(b){switch(this.me.iPlayType){case 4:if(!this.me.bWaitUntilFinish){this.me.bWaitUntilFinish=true;main.Continue()}break;case 5:main.GotoSlideStartNext();break}if(this.me.iLoop==1){this.me.Play()}},hsliderTimeline_change:function(b){if(main.bVideoMoveForward){main.bVideoMoveForward=false;return}this.me.bIsDragging=false;if(this.me.bCantMoveForward){var c=this.currentTime;if(this.currentTime>this.me.playedTime){if(this.currentTime>this.me.nMaxPlayTime){if(Viewer.isIE){sleep(500)}this.currentTime=this.me.currentTime}return}}if(this.me.eboardInfo){this.me.eboardInfo.SetPos(this.currentTime)}}};return a});