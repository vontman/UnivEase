define("QUIZ_OBJECTIVE",["CScript","BitmapAsset","Rectangle","CQuiz_Manager","CQuizInfo","Shape"],function(b,f,c,e,g,d){function a(V,u,v,n,D,ay,ai,ar,h,ae,H,ac,ak,ad,aB,U,ap,ao,aj,R,av,Q,O,M,F,Z,aq,r,P,az,Y,ab,N,at,C,z,p,o,q,w,aw,au,ax,t,aD,s,aC,I,K,am,an,X,E,G,S,al,k,x,y,ah,ag,W,af,T,aa,aA){this.iQuizNo=V||1;this.iQuizType=u||0;this.sID=v||1;this.iLoop=n;this.iDisplayAnswer=D==0?0:(D||1);this.correctSoundAsset=ay||null;this.incorrectSoundAsset=ai||null;this.iDisplayMessage=ar||3;this.sCorrectMessage=h||"";this.sIncorrectMessage=ae||"";if(this.iDisplayMessage==0){this.sCorrectMessage="";this.sIncorrectMessage=""}if(this.iDisplayMessage==1){this.sIncorrectMessage=""}if(this.iDisplayMessage==2){this.sCorrectMessage=""}this.iCorrectAction=H||0;this.iIncorrectAction=ac||0;this.sCorrectSub=ak||"";this.sIncorrectSub=ad||"";this.sButtonName=aB||"";this.sButtonFontMacro=U||"";this.iButtonX=ap||0;this.iButtonY=ao||0;this.iButtonWidth=aj||80;this.iButtonHeight=R||32;this.iButtonType=av||0;this.iButtonColor1=(Q==0)?0:Q||-1;this.iButtonColor2=(O==0)?0:O||-1;this.iButtonColor3=(M==0)?0:M||-1;this.button1BitmapAsset=F||null;this.button2BitmapAsset=Z||null;this.button3BitmapAsset=aq||null;this.iMultipleAnswer=r||0;this.iCorrectAnswer=P||1;this.iChoiceSymbol=az||0;this.choiceFontMacro=Y||"";this.iChoiceShuffle=ab||0;this.iChoiceArrange=N||0;this.iChoiceCount=at||4;this.iChoiceHorzCount=C||1;this.iChoiceVertCount=z||4;this.iChoiceX=p||100;this.iChoiceY=o||140;this.iChoiceW=q||100;this.iChoiceH=w||20;this.iChoiceTabX=aw||32;this.iChoiceTabY=au||16;this.iTextType=ax||0;this.iX1=t==null?100:t;this.iY1=aD==null?100:aD;this.iX2=s==null?200:s;this.iY2=aC==null?120:aC;this.bodyTextBitmapAsset=I||null;this.iPoint=K||1;this.iShowPoint=am||0;this.iRetry=an||0;this.bQuizNumber=X||0;this.iQuizNumber=E||-1;this.sRetryMessage=G||"";this.iRetryAction=S||0;this.sRetrySub=al||"";this.retrySoundAsset=k||null;this.bExplain=x||0;this.iDisplayExplain=y||0;this.explainTextBitmapAsset=ah||null;this.iPX1=ag||0;this.iPY1=W||0;this.iPX2=af||0;this.iPY2=T||0;this.iInTime=aa||-1;this.iOutTime=Number.MAX_VALUE||-1;this.buttonFormat=CTextFormatUtil.parseFontMacro(this.sButtonFontMacro,"center","center");this.choiceFormat=CTextFormatUtil.parseFontMacro(this.choiceFontMacro,"left","top",24);this.pointFormat=CTextFormatUtil.parseFontMacro(this.choiceFontMacro,"left","top",24);if(this.iChoiceSymbol==0&&this.choiceFormat.size>6){this.choiceFormat.size=Number(this.choiceFormat.size)-6}this.choiceBitmapAssetArray=new Array();for(var L=0;L<at;L++){if(L<arguments.length){this.choiceBitmapAssetArray[L]=arguments[66+L];if(this.choiceBitmapAssetArray[L]){this.choiceBitmapAssetArray[L]=arguments[66+L]}}else{this.choiceBitmapAssetArray[L]=null}}if(N==1){this.choiceRect=new Array();var B,m,A,l;for(var J=0;J<at;J++){B=arguments[L+J*4+0+68-2];m=arguments[L+J*4+1+68-2];A=arguments[L+J*4+2+68-2];l=arguments[L+J*4+3+68-2];this.choiceRect[J]=new c(B,m,A-B,l-m)}}if(this.iShowPoint){if(this.iChoiceArrange==0){this.iChoiceY+=Number(this.choiceFormat.size);this.iButtonY+=Number(this.choiceFormat.size)}}}a.prototype=new b();a.prototype.Run=function(Y){Y=Y||false;var o=this.sID==null?"":this.sID.toString();this.iSyncObject=this.CheckSyncObject(Y,"QUIZ_OBJECTIVE",o,this.iInTime,this.iOutTime);if(this.iScriptIndex>=0){this.iIndex=this.iScriptIndex}if(this.iSyncObject==-1){return}var W;var B;var aa;var E=new c();var G=this.iCorrectAnswer;var R=new Array();var J=new Array();var k=main.quiz_Manager;var s=k.FindQuiz_Info(this.iQuizNo);var p=false;if(s&&main.bRunMaster){main.Delete("quiz objt "+o+" portion",true);p=true}if(!s){s=k.AddQuiz(o,this.iQuizNo,this.iPoint,this.iRetry,this.iQuizNumber)}if(s.GetPassed()==-1){for(W=0;W<main.quizNumber.length;W++){if(main.quizNumber[W]==this.iQuizNumber){switch(main.quizResult[W]){case"1":s.SetPassed(1);break;case"0":s.SetPassed(0);break;case"-":s.SetPassed(-1);break}break}}}var Q=main.quizManager;var U;if(p){U=Q.FindQuizIndex(s.strID);var K=Q.GetQuizInfo(U);if(K){K.SetPassed(-1);K.SetSubmitCount(0)}else{s.SetPassed(-1);p=false}}var D=(this.iRetry==1)&&(s.GetPassed()!=-1);if(!p){U=Q.AddQuiz(s,this.iQuizType,this.iLoop,this.iDisplayAnswer,this.correctSoundAsset,this.incorrectSoundAsset,this.sCorrectMessage,this.sIncorrectMessage,this.iCorrectAction,this.iIncorrectAction,this.sCorrectSub,this.sIncorrectSub,this.iMultipleAnswer,this.iCorrectAnswer,this.iChoiceSymbol,this.iChoiceArrange,this.iChoiceCount,this.iChoiceHorzCount,this.iChoiceVertCount,this.iChoiceX,this.iChoiceY,this.iChoiceW,this.iChoiceH,this.iChoiceTabX,this.iChoiceTabY,"",0,null,o,this.iQuizNumber,this.sRetryMessage,this.iRetryAction,this.sRetrySub,this.retrySoundAsset,this.iDisplayExplain,this.explainTextBitmapAsset,new c(this.iPX1,this.iPY1,this.iPX2-this.iPX1,this.iPY2-this.iPY1))}for(W=0;W<this.iChoiceCount;W++){R[W]=W;if(this.iChoiceArrange==1){J[W]=new c(this.choiceRect[W].x,this.choiceRect[W].y,this.choiceRect[W].width,this.choiceRect[W].height)}}if(this.iChoiceShuffle){var m,V;var L,X;for(W=0;W<this.iChoiceCount;W++){V=parseInt((Math.random()*32767)%this.iChoiceCount);m=R[W];R[W]=R[V];R[V]=m;if(this.iChoiceArrange==1){L=J[W].width;X=J[W].height;J[W].width=J[V].width;J[W].height=J[V].height;J[V].width=L;J[V].height=X}}if(this.iMultipleAnswer==0){for(W=0;W<this.iChoiceCount;W++){if(R[W]==this.iCorrectAnswer-1){G=W+1;break}}}else{var q=0;for(W=0;W<this.iChoiceCount;W++){if(this.iCorrectAnswer&(1<<R[W])){q|=(1<<W)}}G=q}}if(this.bodyTextBitmapAsset){var v=CUIComponentFactory.DrawBitmap(this.bodyTextBitmapAsset.bitmapData,this.iX1,this.iY1,this.iX2-this.iX1,this.iY2-this.iY1);if(this.sID){v.setID("quiz objt "+this.sID)}main.Draw(v)}if(this.bQuizNumber){var u;if(this.choiceFormat.kerning==true){u="."+this.iQuizNumber.toString()}else{u=this.iQuizNumber.toString()+"."}var H=CTextFormatUtil.GetFontPointSize(parseInt(this.choiceFormat.size),this.choiceFormat,u);var I=new c();I.top=this.iY1;I.bottom=this.iY2;if(this.choiceFormat.kerning==true){I.left=this.iX2+8;I.right=I.left+(H.x>16?H.x:16)+4}else{I.right=this.iX1-8;I.left=I.right-(H.x>16?H.x:16)-4}var v=new d(I.GetX(),I.GetY(),I.GetWidth(),I.GetHeight());CUIComponentFactory.Text(v,u,I,this.choiceFormat,null,false);if(this.sID){v.setID("quiz objt "+this.sID)}main.Draw(v)}if(this.iShowPoint){var M;var Z=Capabilities.Message(Capabilities.Langueges.QuizPoint);M="[ "+Z+" : "+this.iPoint.toString()+" ]";var N=new c(this.iX1,this.iY2+8,this.iX2-this.iX1,Number(this.pointFormat.size)+4);this.pointFormat.align=(this.pointFormat.kerning==false)?"right":this.pointFormat.align="left";if(Viewer.isIE){N.height+=2}var v=new d(N.x,N.y,N.width,N.height);CUIComponentFactory.Text(v,M,N,this.pointFormat,null,false);if(this.sID){v.setID("quiz objt "+this.sID)}main.Draw(v)}if(this.iChoiceArrange==0){var S,O,P,ab;var z,y;var C;var A;for(W=0;W<this.iChoiceCount;W++){if(W>=this.iChoiceHorzCount*this.iChoiceVertCount){break}z=parseInt((W%this.iChoiceHorzCount));y=parseInt((W/this.iChoiceHorzCount)%this.iChoiceVertCount);S=this.iChoiceX+(this.iChoiceW+this.iChoiceTabX)*z;O=this.iChoiceY+(this.iChoiceH+this.iChoiceTabY)*y;P=S+this.iChoiceW;ab=O+this.iChoiceH;aa=new c(S,O,this.iChoiceW,this.iChoiceH);E=aa.clone();if(this.choiceFormat.kerning==false){E.left-=Number(this.choiceFormat.size);E.width=Number(this.choiceFormat.size)}else{E.left=E.right+Number(this.choiceFormat.size);E.width=Number(this.choiceFormat.size)}var B=main.GetFreeButtonNo(50000);var A=main.bitmapManager.AddBitmapButton(E);var F=null;if(this.choiceBitmapAssetArray[R[W]]){F=CUIComponentFactory.DrawBitmap2(this.choiceBitmapAssetArray[R[W]].bitmapData,aa);F.setAttribute("iButtonNo",B);F.setAttribute("iBitmapID",A);F.setClass("ChoiceBody");F.setStyle("cursor","pointer");F.setStyle("z-index",B);if(this.sID){F.setID("quiz objt "+this.sID)}main.Draw(F)}var x=this.DisplayChoiceSymbol(W,E,W,B,A,U);if(F){if(x){if(!window.buttons){window.buttons=new Array()}window.buttons[A]=x.firstChild;F.divShape.targetChoice=x.firstChild}}if(this.iMultipleAnswer==0){if(W+1==G){Q.SetCorrectButtonNo(U,B)}}else{Q.SetCorrectAnswer(U,G)}}}else{for(W=0;W<this.iChoiceCount;W++){E=J[W].clone();if(this.choiceFormat.kerning==false){E.left-=Number(this.choiceFormat.size);E.width=Number(this.choiceFormat.size)}else{E.left=E.right+Number(this.choiceFormat.size);E.width=Number(this.choiceFormat.size)}var B=main.GetFreeButtonNo(50000);var A=main.bitmapManager.AddBitmapButton(E);var F=null;if(this.choiceBitmapAssetArray[R[W]]){F=CUIComponentFactory.DrawBitmap2(this.choiceBitmapAssetArray[R[W]].bitmapData,J[W]);F.setAttribute("iButtonNo",B);F.setAttribute("iBitmapID",A);F.setClass("ChoiceBody");F.setStyle("cursor","pointer");F.setStyle("z-index",B);if(this.sID){F.setID("quiz objt "+this.sID)}main.Draw(F)}var x=this.DisplayChoiceSymbol(W,E,W,B,A,U);if(F){if(x){if(!window.buttons){window.buttons=new Array()}window.buttons[A]=x.firstChild;F.divShape.targetChoice=x.firstChild}}if(this.iMultipleAnswer==0){if(W+1==G){Q.SetCorrectButtonNo(U,B)}}else{Q.SetCorrectAnswer(U,G)}}}if(!D){aa=new c(this.iButtonX,this.iButtonY,this.iButtonWidth,this.iButtonHeight);B=main.GetFreeButtonNo(60000);if(this.iButtonType==0||this.iButtonType==1||this.iButtonType==4){main.AddButton(B,this.sButtonName,aa,this.iButtonColor1,this.iButtonColor2,this.iButtonColor3,this.iButtonType==4?2:this.iButtonType,"",21,"",this.sButtonFontMacro,null,0,this.buttonFormat,U,-1,-1,-1,-1,-1,-1,"")}else{main.AddButton(B,this.sButtonName,aa,this.button1BitmapAsset,this.button2BitmapAsset,this.button3BitmapAsset,this.iButtonType,"",21,"",this.sButtonFontMacro,null,0,this.buttonFormat,U,-1,-1,-1,-1,-1,-1,"")}main.GetButtonInfo(B).DrawOut();if(this.sID){main.GetButtonInfo(B).setID("quiz objt "+this.sID)}}if(this.bExplain&&(this.iDisplayExplain&8)){if(this.explainTextBitmapAsset){var v=CUIComponentFactory.DrawBitmap(this.explainTextBitmapAsset.bitmapData,this.iPX1,this.iPY1,this.iPX2-this.iPX1,this.iPY2-this.iPY1);if(this.sID){v.setID("quiz objt "+this.sID)}main.Draw(v);Q.SetAlredyDisplayExplain(U,true)}}};a.prototype.DisplayCheckBox=function(o,m,p,k,i,q){var n=new c(o-7,m-4,21,21);main.AddButton(k,"",n,-1,-1,-1,2,"",20,"","",null,0,this.choiceFormat,q,p,-1,-1,-1,i,-1,"");var h=document.createElement("div");h.className="item image shape checkbox ChoiceSymbol";h.style.left=n.x+"px";h.style.top=n.y+"px";h.style.width=n.width+"px";h.style.height=n.height+"px";h.setAttribute("iButtonNo",k);h.setAttribute("iBitmapID",i);var l=document.getElementById("imageCanvas").querySelectorAll(".item.image").length||0;h.style.zIndex=l;var j=document.createElement("input");j.id=j.name=j.type="checkbox";j.id+=this.sID;j.name+=this.sID;j.addEventListener("mouseup",main.EventHandlerMouse);if(this.sID){h.className=h.className+" quiz objt "+this.sID}h.appendChild(j);main.Draw(h);return h};a.prototype.DisplayRaidoButton=function(o,m,p,k,j,q){var n=new c(o-10,m-12,21,21);main.AddButton(k,"",n,-1,-1,-1,2,"",20,"","",null,0,this.choiceFormat,q,p,-1,-1,-1,j,-1,"");var h=document.createElement("div");h.className="item image shape radio ChoiceSymbol";h.style.left=n.x+"px";h.style.top=n.y+"px";h.style.width=n.width+"px";h.style.height=n.height+"px";h.setAttribute("iButtonNo",k);h.setAttribute("iBitmapID",j);var l=document.getElementById("imageCanvas").querySelectorAll(".item.image").length||0;h.style.zIndex=k;var i=document.createElement("input");i.id=i.name=i.type="radio";i.id+=this.sID;i.name+=this.sID;i.addEventListener("mouseup",main.EventHandlerMouse);if(this.sID){h.className=h.className+" quiz objt "+this.sID}h.appendChild(i);main.Draw(h);return h};a.prototype.DisplayChoiceSymbol=function(t,q,u,n,k,v){var w=0;var z=0;if(this.choiceFormat.target=="bottom"){w=(q.height-parseInt(this.choiceFormat.size))}else{if(this.choiceFormat.target=="center"){w=(q.height-parseInt(this.choiceFormat.size))/2}}var j;var i=this.iChoiceSymbol;if(i==0&&t>9){i=3}switch(i){case 0:j=String.fromCharCode(9312+t);q.x-=(Number(this.choiceFormat.size)+Number(this.choiceFormat.size)/2);if(j.length>1){z=parseInt(this.choiceFormat.size)/2}w=w-2;q.offset(-z,w);q.width+=(this.choiceFormat.size<5?Number(this.choiceFormat.size):Number(this.choiceFormat.size)/2);break;case 1:if(this.choiceFormat.target=="center"){w+=(parseInt(this.choiceFormat.size)-14)/2}var r,p;r=q.left+14/2;p=q.top+1+w+14/2;return this.DisplayRaidoButton(r,p,t,n,k,v);case 2:if(this.choiceFormat.target=="center"){w+=(parseInt(this.choiceFormat.size)-14)/2}return this.DisplayCheckBox(q.left,q.top+1+w,t,n,k,v);case 3:if(this.iChoiceCount>10){q.width=q.GetWidth()*2}t++;j=t.toString()+".";z=parseInt(this.choiceFormat.size)+(parseInt(this.choiceFormat.size)/4);w=w+1;q.offset(-z,w);break;case 4:j=String.fromCharCode(97+t)+".";z=parseInt(this.choiceFormat.size)+(parseInt(this.choiceFormat.size)/4);w=w+1;q.offset(-z,w);break;case 5:j=String.fromCharCode(65+t)+".";z=parseInt(this.choiceFormat.size)+(parseInt(this.choiceFormat.size)/4);w=w+1;q.offset(-z,w);break;case 6:var h="가나다라마바사아자차카타파하거너더러머버서어저처커터퍼허고노도로";j=h.charAt(t)+".";q.width+=10;z=parseInt(this.choiceFormat.size)+(parseInt(this.choiceFormat.size)/4);w=w+1;q.offset(-z,w);break}var o=this.choiceFormat.rightMargin;var s=this.choiceFormat.target;this.choiceFormat.rightMargin=-1;this.choiceFormat.target="";var m=main.bitmapManager;main.AddButton(n,"",q,-1,-1,-1,2,"",20,"","",null,0,this.choiceFormat,v,u,-1,-1,-1,k,-1,"");var l=new d(q.x,q.y,q.width,q.height);l.setAttribute("iButtonNo",n);l.setAttribute("iBitmapID",k);l.setClass("ChoiceSymbol");l.setStyle("cursor","pointer");if(this.sID){l.setID("quiz objt "+this.sID)}CUIComponentFactory.Text(l,j,q,this.choiceFormat,false,false);main.Draw(l);this.choiceFormat.rightMargin=o;this.choiceFormat.target=s;return l};return a});