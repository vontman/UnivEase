define("VIDEOOPEN",["CScript","Rectangle","CStopTypeInfiniteLoop","VideoAsset","BitmapAsset","SoundAsset","CCommonUtil","CColorUtil"],function(b,i,c,g,f,e,h,a){function d(j,C,A,z,x,o,s,u,p,t,v,m,r,y,n,l,w,k,B,q){this.object=C||null;this.sID=j||"";this.sFile=C==null?"":typeof C=="string"?C:C.videoSource||C.soundSource;this.iX=A||0;this.iY=z||0;this.iWidth=x||-1;this.iHeight=o||-1;this.iPalette_NotUsed=s||0;this.iDisplayType=u==0?0:u||1;this.bControlBar=p||0;this.sSyncTime=t||"";this.iSyncType=v==0?0:v||2;this.sSlideNameKeep=m||"";this.iMciWmp_NotUsed=r||0;this.bCannotMoveToNeverSeen=y||0;this.iBorderType=n||0;this.iThickness=l||0;this.uBorderColor=w||0;this.bSyncObject=k||0;this.iInTime=B||-1;this.iOutTime=q||Number.MAX_VALUE;this.rectangle=new i(A,z,x,o);this.arraySyncTime=this.ParseSyncTime(this.sSyncTime)}d.prototype=new b();d.prototype.IsSyncObjectVideo=function(){return this.bSyncObject==1};d.prototype.StopType=function(){if(this.iDisplayType==4){return new c()}return null};d.prototype.ParseSyncTime=function(n){var l=[];if(n==""){return l}var k=n.split(",");for(var m in k){var j=k[m];if(j==""){continue}l.push(this.ParseTime(j))}return l};d.prototype.ParseTime=function(l){if(-1==l.indexOf(":")){return parseInt(l)*1000}var k=[];var j=l.split(":");for(var p in j){k.push(parseInt(j[p]))}var o=0;for(var m=0;m<k.length;m++){o=o*60+k[m]}return o*1000};d.prototype.PreRun=function(){if(this.iInTime>=0){return}this.sID=this.sID==-1?main.GetAutoObjectNo():this.sID==null?"":this.sID.toString();if(typeof this.sID=="string"){this.iVideoID=main.FindVideoNo(this.sID)}else{this.iVideoID=Number(this.sID)}if(this.iVideoID==-1){this.iVideoID=main.GetFreeVideoNo(0)}if(this.object instanceof g||this.object instanceof e){var m=main.GetCurrentSlideNo();var j=main.GetSlideIndex(this.sSlideNameKeep)+1;if(j<=0){j=m}for(var l=m;l<=j;l++){main.visitArray[l-1]|=2}var k=main.GetCurrentSlideName();main.VideoAdd(this.object,this.iVideoID,String(this.sFile),this.rectangle,0,Boolean(this.bControlBar),this.arraySyncTime,this.iSyncType,k,this.sSlideNameKeep,Boolean(this.bCannotMoveToNeverSeen),this.sID,Boolean(this.bSyncObject))}};d.prototype.Run=function(m){m=m||false;if(null==this.object){return}if(typeof this.sID=="string"){this.iVideoID=main.FindVideoNo(this.sID)}else{this.iVideoID=Number(this.sID)}if(this.iVideoID==-1){this.iVideoID=main.GetFreeVideoNo(0)}if(main.nSlideSyncObject==1){this.bSyncObject=0}if(this.bSyncObject){main.nVideoNoSyncObject=this.iVideoID;this.iInTime=-1;this.iOutTime=Number.MAX_VALUE}this.iSyncObject=this.CheckSyncObject(m,"VIDEOOPEN",this.sID,this.iInTime,this.iOutTime);if(this.iScriptIndex>=0){this.iIndex=this.iScriptIndex}if(this.iSyncObject==-1){return}main.nLastVideoNo=this.iVideoID;if(this.object instanceof g||this.object instanceof e){var j=main.GetCurrentSlideName();main.VideoAdd(this.object,this.iVideoID,String(this.sFile),this.rectangle,this.iDisplayType,Boolean(this.bControlBar),this.arraySyncTime,this.iSyncType,j,this.sSlideNameKeep,Boolean(this.bCannotMoveToNeverSeen),this.sID,Boolean(this.bSyncObject))}else{if(this.object instanceof f){var o=document.createElement("div");o.className="item image shape";o.style.left=this.rectangle.x+"px";o.style.top=this.rectangle.y+"px";o.style.width=this.rectangle.width+"px";o.style.height=this.rectangle.height+"px";o.style.zIndex=document.getElementById("imageCanvas").querySelectorAll(".item.image").length||0;var l=this.object.bitmapData;l.className="content";l.setAttribute("width",this.rectangle.width+"px");l.setAttribute("height",this.rectangle.height+"px");o.appendChild(l);main.Draw(o)}}if(this.iBorderType instanceof f){}else{if(this.iThickness){var n=main.VideoManager().GetVideoInfo(this.iVideoID);if(n&&n.videoPlayer){var k=n.videoPlayer.videoDisplay;k.style.borderStyle="solid";k.style.borderWidth=Number(this.iThickness)+"px";k.style.borderColor=a.RGBColor(Number(this.uBorderColor))}}}};return d});