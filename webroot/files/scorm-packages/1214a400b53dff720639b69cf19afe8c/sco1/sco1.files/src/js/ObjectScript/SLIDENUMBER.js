define("SLIDENUMBER",["CScript","CTextFormatUtil","Rectangle","Shape"],function(b,a,c,d){function e(i,l,g,k,h,j,m,f){this.x1=i||0;this.y1=l||0;this.x2=g||-1;this.y2=k||-1;this.NumberType=h||1;this.sFontMacro=j||"";this.iInTime=m||-1;this.iOutTime=f||Number.MAX_VALUE;this.iSyncObject=0;this.iIndex=0;this.rect=new c(i,l,g-i,k-l);this.format=a.parseFontMacro(this.sFontMacro);this.edgeFormat=a.parseEdgeMacro(this.sFontMacro)}e.prototype=new b();e.prototype.Run=function(m){m=m||false;this.iSyncObject=this.CheckSyncObject(m,"SLIDENUMBER",this.sID,this.iInTime,this.iOutTime);if(this.iScriptIndex>=0){this.iIndex=this.iScriptIndex}if(this.iSyncObject==-1){return}var j="";var p;var o;if(this.NumberType==0){p=main.GetCurrentSlideNo();j=p.toString()}else{p=main.GetCurrentSlideNo();o=main.GetSlideCount();j=p.toString()+"/"+o.toString()}var g=Number(this.edgeFormat.size);var i=Number(this.edgeFormat.indent);var k=Number(this.format.rightMargin);var n=this.rect.clone();shape=new d(n.x,n.y,n.width,n.height);if(k!=-1){CUIComponentFactory.fillRectangle(shape,0,0,n.width,n.height,k)}var f=new c(0,0,n.width,n.height);f.inflate(-i,-i);CUIComponentFactory.Text(shape,j,f,this.format);if(this.edgeFormat.size){if(this.edgeFormat.blockIndent==0){var l=g/2;n.inflate(-l,-l);n.offset(-g,-g);var h=new d(n.x,n.y,n.width,n.height);h.graphics.drawImage(shape.divCanvas,0,0);CUIComponentFactory.DrawRectangle3(h,this.edgeFormat.size,this.edgeFormat.color);shape=h}else{if(Viewer.isIE){CUIComponentFactory.DrawRectangle3(shape,this.edgeFormat.size,this.edgeFormat.color,"dashed")}else{CUIComponentFactory.DrawRectangle4(shape,this.edgeFormat.size,this.edgeFormat.color,this.edgeFormat.blockIndent)}}}main.Draw(shape);if(this.sID){shape.setID(this.sID)}};return e});