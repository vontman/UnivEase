define("CButtonInfo",["Shape","CUIComponentFactory","BitmapAsset","SOUND","SoundAsset","Rectangle","QUIZ_OBJECTIVE"],function(c,a,g,e,f,i,j){ButtonState={Normal:0,Over:1,Click:2};var b=null;var h=null;function d(y,I,F,B,J,E,m,z,C,r,H,w,q,x,o,s,D,A,t,G,l,k,p,n,u,v){this.iButtonNo=y;this.sID=k;this.sButtonName=I;this.rectangle=F;this.bEnabled=true;this.iKeepAlive=q||0;this.Normal=(B==0)?0:B||-1;this.Over=(J==0)?0:J||-1;this.Click=(E==0)?0:E||-1;this.nButtonType=m;this.sSub=z;this.nActionType=C;this.sToolTip=r;this.sFontMacro=H;this.format=x;this.nQuizInfoIndex=o;this.nQuizChoiceNo=s;this.nIconFunction=(D==0)?0:D||-1;this.nSoundVolume=A||-1;this.soundAsset=w;this.iBitmapID=G==0?0:G||-1;this.iDisappearGroupID=l||-1;this.nOverAction=p;this.sOverSub=n;this.nOutAction=u;this.sOutSub=v;this.bIconPlay=false;this.soundChannel=null;this.soundPausePos=0;this.soundLoop=t||0;this.tooltip=null;this.tooltipTimer;this.ImageButtonBitmapID=-1;this.iSlideNo=0;this.IsSoundButton=false;this.bClosed=false;if(r&&r.length>0){this.tooltip=r}this.nAction}d.prototype={GetRectangle:function(){return this.rectangle},GetDisappearGroupID:function(){return this.iDisappearGroupID},GetBitmapID:function(){return this.iBitmapID},IsIconPlay:function(){return this.bIconPlay},SetIconPlay:function(k){this.bIconPlay=k},SetSoundButton:function(k){this.IsSoundButton=k},GetNormal:function(){return this.Normal},GetClick:function(){return this.Click},SetNormal:function(k){this.Normal=k},SetClick:function(k){this.Click=k},Enabled:function(k){this.bEnabled=k;this.DrawButton();if(this.shape){this.shape.addStyle("cursor",this.bEnabled?"pointer":null)}},IsGeneral:function(){if((0<=this.iButtonNo)&&(this.iButtonNo<80000)){return true}if(89999<this.iButtonNo){return true}return false},IsProgress:function(){if((80000<=this.iButtonNo)&&(this.iButtonNo<=89999)){return true}return false},IsKeepAlive:function(){if(this.iKeepAlive==1){return true}return false},IsAreaButton:function(){if(this.nButtonType==2&&this.Normal==-1&&this.Over==-1&&this.Click==-1){return true}return false},IsTextButton:function(){if(this.nButtonType==2&&typeof this.Normal=="number"&&typeof this.Over=="number"&&typeof this.Click=="number"&&this.Normal!=-1&&this.Over!=-1&&this.Click!=-1){return true}return false},IsBasicButton:function(){if(typeof this.Normal=="number"&&typeof this.Over=="number"&&typeof this.Click=="number"){return true}return false},IsBasicDefaultColorButton:function(){if(this.IsBasicButton()&&this.Normal==-1&&this.Over==-1&&this.Click==-1){return true}return false},IsImageButton:function(){if(this.Normal instanceof g||this.Over instanceof g||this.Click instanceof g){return true}return false},ButtonNo:function(){return this.iButtonNo},sID:function(){return this.sID},nQuizInfoIndex:function(){return this.nQuizInfoIndex},SetSoundPausePos:function(k){this.soundPausePos=k},Contains:function(k){var l=this.rectangle.containsPoint(k);if(this.bEnabled&&l){return true}return false},EqualsButtonNo:function(k){if(this.iButtonNo==k){return true}return false},setCaption:function(k){this.sButtonName=k},getColorByButtonState:function(l){var k=this.Normal;switch(l){case ButtonState.Over:k=this.Over;break;case ButtonState.Click:k=this.Click;break}return k},getImageByButtonState:function(l){var k=this.getColorByButtonState(l);return k},DrawOver:function(){if(this.nActionType==20){return}this.DrawButton(1);if(this.nOverAction!=0){this._Action(0)}if(this.tooltip){document.getElementById("imageCanvas").setAttribute("title",this.tooltip)}},DrawOut:function(){if(this.nActionType==20){return}this.DrawButton(0);if(this.tooltip){document.getElementById("imageCanvas").removeAttribute("title")}},StopSound:function(){if(this.soundChannel!=null){this.soundChannel.pause()}},RedrawOut:function(){if(!main.Contains(this.shape)){main.Draw(this.shape)}if(this.bEnabled){this.DrawButton(0,true)}else{this.DrawButton(2,true)}},DrawButton:function(o,k){if(!this.shape){this.shape=new c(this.rectangle.x,this.rectangle.y,this.rectangle.width+1,this.rectangle.height+1);if(this.sID){this.shape.setID(this.sID)}this.shape.addStyle("cursor","pointer");this.shape.addStyle("zIndex",this.iButtonNo);this.setMouseEventHandler(this.shape.divShape);main.Draw(this.shape)}if(o==undefined){if(this.bEnabled){o=0}else{o=2}}if(this.IsAreaButton()||this.IsTextButton()){this.shape.graphics.clearRect(0,0,this.shape.divCanvas.width,this.shape.divCanvas.height)}else{if(this.IsBasicButton()){var q,m,p;if(this.IsBasicDefaultColorButton()){p=15790320}else{switch(o){case 0:p=this.Normal==-1?15790320:parseInt(this.Normal);break;case 1:p=this.Over==-1?15790320:parseInt(this.Over);break;case 2:p=this.Click==-1?15790320:parseInt(this.Click);break}}a.DrawButton(this.shape,1,0,p,o)}else{var l;switch(o){case 0:l=(this.Normal instanceof g)?this.Normal.bitmapData:this.Normal&&this.Normal.localName=="canvas"?this.Normal:null;break;case 1:l=(this.Over instanceof g)?this.Over.bitmapData:this.Over&&this.Over.localName=="canvas"?this.Over:null;break;case 2:l=(this.Click instanceof g)?this.Click.bitmapData:this.Click&&this.Click.localName=="canvas"?this.Click:null;break}a.DrawBitmapButton(this.shape,l,this.rectangle.width,this.rectangle.height)}}if(this.IsTextButton()){switch(o){case 0:this.format.color=this.Normal;break;case 1:this.format.color=this.Over;break;case 2:this.format.color=this.Click;break}}var n=this.rectangle.clone();if(o==2&&!this.IsTextButton()&&!this.IsAreaButton()){n.offset(-n.x+1,-n.y+1)}else{n.offset(-n.x,-n.y)}if(this.format){a.Text(this.shape,this.sButtonName,n,this.format,false)}if(this.sToolTip.length>0){this.shape.addToolTip(this.sToolTip)}},setMouseEventHandler:function(k){k.me=this;k.onmouseover=this.MouseEventHandler;k.onmouseout=this.MouseEventHandler;k.onmousedown=this.MouseEventHandler;k.onmouseup=this.MouseEventHandler;k.onclick=this.MouseEventHandler},MouseEventHandler:function(l){var k=this.me;if(!k.bEnabled){return}switch(l.type){case"mouseover":if(l.target.parentNode){k.DrawButton(ButtonState.Over);if(k.nOverAction!=0){k._Action(0)}}break;case"mouseout":if(l.target.parentNode){k.DrawButton(ButtonState.Normal);if(k.nOutAction!=0){k._Action(2)}}break;case"mousedown":if(l.target.parentNode){k.DrawButton(ButtonState.Click)}break;case"mouseup":if(l.target.parentNode){k.DrawButton(ButtonState.Over)}break;default:main.bRunMaster=false;k.Action()}},Action:function(){if(main.GlobalPause()){switch(this.nActionType){case 16:break;case 19:break;default:return}}if(this.soundAsset!=null){if(this.nIconFunction==-1){if(0){main.StopButtonSound();this.soundChannel=this.soundAsset.soundData;this.soundChannel.play()}else{if(h){if(h.currentTime){h.currentTime=0}h.pause();h=null}if(this.soundAsset instanceof f&&this.soundAsset.soundData.currentSrc!=""){b=this.soundAsset;h=b.soundData;h.play()}}}else{main.StopPreSoundIcon(this.iButtonNo);e.prototype.SlideStart();main.StopButtonSoundExcept(this.iButtonNo);this.bIconPlay=!this.bIconPlay;var l=this.Normal;this.Normal=this.Click;this.Click=l;switch(this.nIconFunction){case 0:if(this.nSoundVolume>=0){this.soundAsset.soundData.volume=this.nSoundVolume}if(this.bIconPlay){this.soundChannel=this.soundAsset.soundData;if(this.soundChannel.currentTime){this.soundChannel.currentTime=this.soundPausePos}this.soundChannel.play()}else{if(this.soundChannel){this.soundPausePos=this.soundChannel.currentTime;this.soundChannel.pause()}}break;case 1:if(this.nSoundVolume>=0){this.soundAsset.soundData.volume=this.nSoundVolume}if(this.bIconPlay){this.soundChannel=this.soundAsset.soundData;if(this.soundChannel.currentTime){this.soundChannel.currentTime=this.soundPausePos}this.soundChannel.play()}else{if(this.soundChannel){this.soundChannel.pause()}}break;case 2:if(this.nSoundVolume>=0){this.soundAsset.soundData.volume=this.nSoundVolume}else{this.soundAsset.soundData.volume=1}if(this.soundChannel==null){this.soundChannel=this.soundAsset.soundData;if(this.soundChannel.currentTime){this.soundChannel.currentTime=-1}if(this.bIconPlay){this.soundChannel.play()}}else{this.soundChannel.play();if(this.bIconPlay){this.soundChannel.volume=this.nSoundVolume}else{this.nSoundVolume=this.soundChannel.volume;this.soundChannel.volume=0}}break}if((this.soundLoop==1||this.soundLoop==2)&&this.soundChannel){this.soundChannel.me=this;this.soundChannel.addEventListener("ended",this.soundCompleteHandler)}}}if(this.iKeepAlive==2){main.Remove(this.iButtonNo);var k=document.getElementById("imageCanvas");if(k){k.style.cursor=""}}this._Action(1)},_Action:function(A){var p=main.bitmapManager;var B=A==1?this.nActionType:A==0?this.nOverAction:this.nOutAction;var w=A==1?this.sSub:A==0?this.sOverSub:this.sOutSub;var D=false;switch(B){case 2:main.GotoSlideStartPrev();break;case 3:main.GotoSlideStartNext();break;case 4:main.GotoSlideStartFirst();break;case 5:main.GotoSlideStartLast();break;case 6:if(this.sSub){main.GotoSlideStart(w)}break;case 7:main.GotoSlideStartCurrent();break;case 8:main.GotoSlideStartBefore();break;case 10:window.open(w,"_blank");break;case 11:window.open(w,"_blank");break;case 13:window.open(w,"_blank");break;case 14:window.open(w,"_blank");break;case 15:window.open(w,"_self");break;case 12:case 16:if(Viewer.isIOSApp){document.location="ABridge::loadIntro?"}else{if(Viewer.isAnApp){window.ABridge.loadIntro()}else{window.open("","_self","");window.close()}}break;window.open("","_self","");window.close();break;case -1:main.RunMaster(w);break;case 1:var q=0,o=0;var l="";var k=w.indexOf("(");if(k>0){l=w.substring(0,k);q=parseInt(w.substring(k+1));k=w.indexOf(",",k);o=parseInt(w.substring(k+1));main.RunMaster(l,q,o)}break;case 20:this.QuizChoiced();break;case 21:this.QuizSubmitted();break;case 18:main.PauseAllMedia();break;case 19:main.ResumeAllMedia();break;case 22:if(this.iDisappearGroupID==-1){p.RestoreBitmapButton(this.iBitmapID);main.Remove(this.iButtonNo)}else{main.RemoveSameDisappearGroupButton(this.iDisappearGroupID)}break;case 24:var s=document.getElementsByClassName("item "+w);if(s[0]&&main.Contains(s[0])){D=true}case 23:var s=document.getElementsByClassName("item "+w);var r=false;for(var u=0;u<s.length;u++){var E=p.GetCloseCommandName(s[u]);var m;if(D){this.bClosed=false}else{if(s[u]){if(s[u].style.display=="none"){this.bClosed=true}else{this.bClosed=false}}}switch(E){case"BROWSER":m=main.FindBrowserNo(this.sSub);var t=main.BrowserManager().GetBrowserInfo(m);if(this.bClosed){t.Show()}else{if(D){main.BrowserManager().Remove(m)}else{t.Hide()}}break;case"QUIZ_SUBJECTIVE":if(s[u]&&main.Contains(s[u])){if(D){main.Clear(s[u]);u--}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}}break;case"QUIZ_OBJECTIVE":if(!r){m=main.quizManager.FindQuizIndex(w);if(this.bClosed){main.mouseManager.SetEnableQuiz(true,m);if(main.quizManager.GetOldPassed(m)==-1){main.quizManager.SetPassed(m,-1)}}else{main.mouseManager.SetEnableQuiz(false,m);var C=main.quizManager.GetPassed(m);main.quizManager.SetOldPassed(m,C);if(C==-1){main.quizManager.SetPassed(m,0)}}}r=true;if(s[u]&&main.Contains(s[u])){if(D){main.Clear(s[u]);u--}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}}break;case"EBOARD":m=main.FindEBoardNo(w);var n=main.FindEBoard(m);if(this.bClosed){n.Show(true)}else{if(D){n.Hide(false);n.Delete()}else{n.Hide(false)}}if(s[u]&&main.Contains(s[u])){if(D){main.Clear(s[u])}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}}break;case"MENUBUTTON":m=main.ControlManager().FindControlNo(w);var z=main.ControlManager().GetControlInfo(m);if(D){z.Hide()}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}break;case"VIDEOOPEN":m=main.FindVideoNo(w);if(this.bClosed){main.VideoShow(m,true)}else{if(D){main.VideoDelete(m)}else{main.VideoHide(m,false)}}if(s[u]&&main.Contains(s[u])){if(D){main.Clear(s[u])}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}}break;default:if(s[u]&&main.Contains(s[u])){if(D){main.Clear(s[u]);u--}else{if(this.bClosed){s[u].style.display=""}else{s[u].style.display="none"}}}if(E=="BUTTONSET"){var v=main.MouseManager().FindButtonNo(w);main.SetEnable(v,this.bClosed)}break}}break;case 25:case 9:case 17:break}},soundCompleteHandler:function(k){if(this.me.soundLoop==2){this.removeEventListener("ended",this.me.soundCompleteHandler,false);this.me.soundLoop=0;main.Continue()}if(this.me.soundLoop==1){this.play()}},IsQuizPassed:function(){return main.quizManager.IsPassed(this.nQuizInfoIndex)},QuizChoiced:function(){if(this.nQuizInfoIndex==-1){return}var s;var r=main.quizManager;if(this.IsQuizPassed()){return}var m="";if(Viewer.isIE){if(event&&event.srcElement&&event.srcElement.parentElement){var k=event.srcElement.parentElement.className;if(k){var p=k.indexOf("quiz objt");m=k.substring(p)}}}else{if(event&&event.target&&event.target.parentElement){var k=event.target.parentElement.className;if(k){var p=k.indexOf("quiz objt");m=k.substring(p)}}}if(!r.IsMultipleAnswer(this.nQuizInfoIndex)){r.SetUserAnswer(this.nQuizInfoIndex,this.iButtonNo)}else{s=r.GetUserAnswer(this.nQuizInfoIndex);r.SetUserAnswer(this.nQuizInfoIndex,s^(1<<this.nQuizChoiceNo));s=r.GetUserAnswer(this.nQuizInfoIndex)}var l;var o=main.mouseManager.GetButtonCount();var n;for(n=0;n<o;n++){l=main.mouseManager.GetButtonInfobyIndex(n);if(l.nQuizInfoIndex==this.nQuizInfoIndex){if(l.nQuizChoiceNo>=0){var q=main.BitmapManager();q.RestoreBitmapButton(l)}}}if(!r.IsMultipleAnswer(this.nQuizInfoIndex)){this.DisplayCheckMark(this,m)}else{for(n=0;n<o;n++){l=main.mouseManager.GetButtonInfobyIndex(n);if(l.nQuizInfoIndex==this.nQuizInfoIndex){if(l.nQuizChoiceNo>=0){if(s&(1<<l.nQuizChoiceNo)){this.DisplayCheckMark(l,m)}}}}}},DisplayCheckMark:function(l,n){var z=main.quizManager;var t=new i();t=l.rectangle.clone();var o;o=(l.format.kerning==true);if(o==true){t.left=t.right-parseInt(l.format.size)}var A=0;if(l.format.target=="bottom"){A=(t.height-parseInt(l.format.size))}else{if(l.format.target=="center"){A=(t.height-parseInt(l.format.size))/2}}if(z.IsRadioButtonQuiz(l.nQuizInfoIndex)){if(l.format.target=="center"){A+=(parseInt(l.format.size)-14)/2}var u,s;u=t.left+14/2;s=t.top+1+A+14/2}else{if(z.IsCheckBoxQuiz(l.nQuizInfoIndex)){if(l.format.target=="center"){A+=(parseInt(l.format.size)-14)/2}}else{if(l.format.target=="center"){A+=(parseInt(l.format.size)-20)/2}var m=Viewer._CheckBlue_;var u=t.left;var s=t.top;var v=t.width;var p=t.height/2;var k=new i(u,s,v,p);var q=a.DrawBitmap(m.bitmapData,u,s,v,p);q.setID(l.iButtonNo);q.setID(n);q.setID("Choiced");q.setID("portion");q.setAttribute("iButtonNo",l.iButtonNo);q.setAttribute("iBitmapID",l.iBitmapID);q.setStyle("cursor","pointer");main.Draw(q)}}},QuizSubmitted:function(){if(this.nQuizInfoIndex==-1){return}var W=main.quizManager;if(this.IsQuizPassed()){return}var G="";if(Viewer.isIE){if(event&&event.srcElement&&event.srcElement.parentElement){var t=event.srcElement.parentElement.className;if(t){var I=t.indexOf("quiz objt");G=t.substring(I)}}}else{if(event&&event.target&&event.target.parentElement){var t=event.target.parentElement.className;if(t){var I=t.indexOf("quiz objt");G=t.substring(I)}}}var p=W.GetQuizType(this.nQuizInfoIndex);var Y;if(p==0){var C=W.GetUserAnswer(this.nQuizInfoIndex);var K;if(!W.IsMultipleAnswer(this.nQuizInfoIndex)){K=W.GetCorrectButtonNo(this.nQuizInfoIndex)}else{K=W.GetCorrectAnswer(this.nQuizInfoIndex)}Y=C==K}else{var ae=W.GetCorrectAnswerText(this.nQuizInfoIndex);var S=W.GetText(this.nQuizInfoIndex);var ac=W.GetDecisionType(this.nQuizInfoIndex);if(ac&1){ae=ae.replace(/ /g,"");ae=ae.replace(/\t/g,"");ae=ae.replace(/\r/g,"");ae=ae.replace(/\n/g,"");S=S.replace(/ /g,"");S=S.replace(/\t/g,"");S=S.replace(/\r/g,"");S=S.replace(/\n/g,"")}if(ac&4){for(var Z=33;Z<127;++Z){if((Z>=33&&Z<=47)||(Z>=58&&Z<=64)||(Z>=91&&Z<=96)||(Z>=123&&Z<=126)){var L=String.fromCharCode(Z);ae=ae.replace(L,"");S=S.replace(L,"")}}}if(ac&2){Y=S.toLowerCase()==ae.toLowerCase()}else{Y=S==ae}}var n=null;var o;var X;var A;var T=0;var H=1;var M;T=W.GetSubmitCount(this.nQuizInfoIndex);H=W.GetLoopCount(this.nQuizInfoIndex);M=T+1<H;n=W.GetSoundAsset(this.nQuizInfoIndex,Y,M);o=W.GetMessage(this.nQuizInfoIndex,Y,M);X=W.GetAction(this.nQuizInfoIndex,Y,M);A=W.GetSub(this.nQuizInfoIndex,Y,M);if(h){if(h.currentTime){h.currentTime=0}h.pause();h=null}if(n){b=n;h=b.soundData;h.play()}var N=W.GetDisplayExplain(this.nQuizInfoIndex);var m=W.GetAlredyDisplayExplain(this.nQuizInfoIndex);var v=N&&!m&&(((N&1)&&Y)||((N&2)&&!Y&&!M)||((N&4)&&!Y&&M));if(v){var ad=W.GetExplainTextBitmapAsset(this.nQuizInfoIndex);if(ad){var z=a.DrawBitmap2(ad.bitmapData,W.GetRcExplain(this.nQuizInfoIndex));z.setID(G);main.Draw(z);W.SetAlredyDisplayExplain(this.nQuizInfoIndex,true)}}if(W.GetDisplayAnswer(this.nQuizInfoIndex)){if(!Y&&T+1>=H){if(p==0){var F;var J;var l=0;var u;var s;var D;if(!W.IsMultipleAnswer(this.nQuizInfoIndex)){K=W.GetCorrectButtonNo(this.nQuizInfoIndex);F=main.GetButtonInfo(K);J=new i();J=F.rectangle.clone();u=parseInt(F.format.size);if(F.format.kerning==true){J.left=J.right-u}s=F.format.target;if(s=="bottom"){l=(J.height-u)}else{if(s=="center"){l=(J.height-u)/2}}if(s=="center"){l+=(u-20)/2}D=Viewer._CheckRed_;var Q=J.left;var P=J.top+1+l-J.height/2;var R=J.width;var aa=J.height/2;var U=new i(Q,P,R,aa);var z=a.DrawBitmap(D.bitmapData,Q,P,R,aa);z.setID(G);z.setID("portion");main.Draw(z)}else{K=W.GetCorrectAnswer(this.nQuizInfoIndex);var V=main.mouseManager.GetButtonCount();for(var Z=0;Z<V;Z++){F=main.mouseManager.GetButtonInfobyIndex(Z);if(F.nQuizInfoIndex==this.nQuizInfoIndex){if(F.nQuizChoiceNo>=0){if(K&(1<<F.nQuizChoiceNo)){J=new i();J=F.rectangle.clone();u=parseInt(F.format.size);if(F.format.kerning==true){J.left=J.right-u}s=F.format.target;if(s=="bottom"){l=(J.height-u)}else{if(s=="center"){l=(J.height-u)/2}}if(s=="center"){l+=(u-20)/2}D=Viewer._CheckRed_;var Q=J.left;var P=J.top+1+l-J.height/4;var R=J.width;var aa=J.height/2;var U=new i(Q,P,R,aa);var z=a.DrawBitmap(D.bitmapData,Q,P,R,aa);z.setID(G);z.setID("portion");main.Draw(z)}}}}}}else{var E=W.GetCorrectAnswerText(this.nQuizInfoIndex);W.SetTextArea(this.nQuizInfoIndex,E)}}}this.nAction=X;this.sSub=A;if(o.length>0){var q=Y?1:4;jAlert(o,"",q,this.iButtonNo)}W.IncreaseSubmitCount(this.nQuizInfoIndex);if(!Y&&(T+1<H)){}else{if(p==0){}W.SetPassed(this.nQuizInfoIndex,(Y?1:0));if(W.GetQuizNo(this.nQuizInfoIndex)==Viewer.QuizTotalCount){try{ExternalInterface.call("sendScore")}catch(ab){}}}if(!(o.length>0)){this.doAction(this.nAction,this.sSub)}var O=W.GetQuizInfo(this.nQuizInfoIndex);if(this.IsQuizPassed()){if(O.IsCheckBoxQuiz()||O.IsRadioButtonQuiz()){var C=O.GetUserAnswer();var K=O.GetCorrectAnswer();var p=O.GetQuizType();var k=(O.IsCheckBoxQuiz()?"checkbox":"radio")+O.sID;var B=document.getElementsByName(k);for(var Z=0;Z<B.length;++Z){B[Z].onclick=function(r){return false}}}}},doAction:function(l,k){switch(l){case 1:main.RunMaster(k);break;case 2:main.GotoSlideStartPrev();break;case 3:main.GotoSlideStartNext();break;case 5:main.GotoSlideStartCurrent();break;case 4:main.GotoSlideStart(k);break}},closeHandler:function(k){this.doAction(this.nAction,this.sSub)},setID:function(k){this.shape.setID(k)}};return d});